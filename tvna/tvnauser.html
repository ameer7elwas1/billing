<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TV HUB</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }
        .logo-text {
            font-family: 'Orbitron', 'Tajawal', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', 'Tajawal', sans-serif;
        }

        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #ff9e00;
            --danger: #e74c3c;
            --dark: #0a0a0a;
            --darker: #121212;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --premium: linear-gradient(135deg, #ff9e00, #ff6b35);
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-light: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 12px 40px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.3);
            --gradient-bg: linear-gradient(135deg, var(--darker), var(--dark));
            --gradient-card: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(58, 12, 163, 0.1));
        }

        body {
            background: var(--gradient-bg);
            color: white;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            font-weight: 400;
            line-height: 1.6;
            direction: rtl;
            text-align: right;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(67, 97, 238, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(247, 37, 133, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(58, 12, 163, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        
        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
        }
        .page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .loader-content {
            text-align: center;
        }
        .loader-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #7c3aed 60%, #5f27cd 100%) !important;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem;
        }

        .loader-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(67, 97, 238, 0.3);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            margin: 1rem auto;
        }

        header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-medium);
            border-bottom: 1px solid var(--glass-border);
        }

        header.scrolled {
            padding: 0.5rem 2rem;
            background: rgba(10, 10, 10, 0.98);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
        }


        .logo-icon {
            width: 80px !important;
            height: 80px !important;
            background: linear-gradient(135deg, #7c3aed 60%, #5f27cd 100%) !important;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
        }

        .logo-text {
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(90deg, #ff9e00, #4361ee 80%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 18px rgba(255, 158, 0, 0.13);
            letter-spacing: 2px;
        }

        .nav-links {
            display: flex;
            gap: 0.5rem;
            background: var(--glass);
            padding: 0.5rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .nav-link {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .nav-link::before, .nav-link:after {
            border-bottom: none !important;
            text-decoration: none !important;
            box-shadow: none !important;
        }

        .nav-link:hover::before, .nav-link:hover, .nav-link.active {
            background: var(--premium);
            color: white;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 0;
            padding: 0.8rem;
            border: none;
            border-radius: 25px;
            background: var(--glass);
            color: white;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .search-input.active {
            width: 250px;
            padding-right: 3rem;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .action-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
        }

        .action-btn::before, .action-btn::after {
            border-bottom: none !important;
            text-decoration: none !important;
            box-shadow: none !important;
        }

        .action-btn:hover::before, .action-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass);
            font-size: 1.2rem;
            position: relative;
        }

        .user-avatar::before, .user-avatar::after {
            border-bottom: none !important;
            text-decoration: none !important;
            box-shadow: none !important;
        }

        .user-avatar.logged-in {
            background: var(--premium);
            border-color: var(--warning);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .connection-status {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 0.8rem 1.2rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            z-index: 1001;
            min-width: 250px;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateX(100%);
        }

        .connection-status.show {
            opacity: 1;
            transform: translateX(0);
        }

        .connection-status.connected {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(40, 167, 69, 0.1));
        }

        .connection-status.connecting {
            border-color: var(--warning);
            background: linear-gradient(135deg, rgba(255, 158, 0, 0.1), rgba(255, 107, 53, 0.1));
        }

        .connection-status.error {
            border-color: var(--danger);
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.1), rgba(220, 53, 69, 0.1));
        }

        .hero {
            padding: 4rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at center, rgba(67, 97, 238, 0.1) 0%, transparent 50%);
            animation: heroRotate 20s linear infinite;
        }

        @keyframes heroRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .welcome-card {
            background: rgba(30,32,48,0.82);
            backdrop-filter: blur(32px) saturate(140%);
            padding: 2.2rem 3.5rem 1.7rem 3.5rem;
            border-radius: 32px;
            max-width: 700px;
            min-width: 420px;
            width: 100%;
            min-height: 270px;
            box-shadow: 0 8px 40px 0 rgba(124,60,237,0.18), 0 1.5px 8px 0 rgba(247,37,133,0.10), 0 0 32px 0 #7c3aed33;
            position: relative;
            overflow: hidden;
            border: 2.5px solid #7c3aed;
            z-index: 1;
            margin: 0 auto 2.2rem auto;
            animation: cardPopIn 0.8s cubic-bezier(.23,1.12,.72,1.01);
            transition: box-shadow 0.3s, transform 0.3s, border-color 0.3s;
        }
        .welcome-card:hover {
            box-shadow: 0 16px 64px 0 #ff9e0033, 0 0 32px 0 #7c3aed88;
            transform: scale(1.025) translateY(-6px);
            border-color: #ff9e00;
        }
        .welcome-card::before {
            content: '';
            position: absolute;
            top: -30%;
            left: -30%;
            width: 160%;
            height: 160%;
            background: radial-gradient(circle at 70% 30%, rgba(124,60,237,0.18) 0%, transparent 70%),
                        radial-gradient(circle at 30% 70%, rgba(255,158,0,0.13) 0%, transparent 70%);
            z-index: 0;
            animation: bgMove 8s linear infinite alternate;
        }
        .welcome-card::after {
            content: '';
            position: absolute;
            top: 0; left: -60%;
            width: 220%; height: 100%;
            background: linear-gradient(120deg, rgba(255,255,255,0.13) 0%, rgba(255,255,255,0.01) 100%);
            pointer-events: none;
            transform: skewX(-20deg);
            z-index: 2;
        }
        @keyframes shineAnim {
            0% { left: -60%; }
            60% { left: 120%; }
            100% { left: 120%; }
        }
        @keyframes cardPopIn {
            0% { opacity: 0; transform: scale(0.95) translateY(40px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        @keyframes bgMove {
            0% { background-position: 0% 0%, 100% 100%; }
            100% { background-position: 100% 100%, 0% 0%; }
        }
        .welcome-title {
            font-size: 2.1rem;
            margin-bottom: 0.6rem;
            position: relative;
            z-index: 2;
            font-weight: 900;
            background: linear-gradient(90deg, #ff9e00, #4361ee 80%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 18px rgba(255, 158, 0, 0.13);
        }
        .welcome-subtitle {
            font-size: 1.08rem;
            opacity: 0.93;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 2;
            font-weight: 400;
        }
        .stats-grid {
            display: flex;
            justify-content: center;
            gap: 1.7rem;
            width: 100%;
            margin-bottom: 1.1rem;
            position: relative;
            z-index: 2;
        }
        .stat-card {
            background: rgba(255,255,255,0.13);
            border: 1px solid rgba(255,255,255,0.13);
            box-shadow: 0 1.5px 8px 0 rgba(67,97,238,0.08);
            padding: 1rem 0.8rem 0.7rem 0.8rem;
            border-radius: 13px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.2rem;
            min-width: 90px;
            max-width: 120px;
            transition: all 0.22s cubic-bezier(.23,1.12,.72,1.01);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        .stat-card::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(120deg,rgba(255,255,255,0.08) 0%,rgba(255,255,255,0.01) 100%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }
        .stat-card:hover::after {
            opacity: 1;
        }
        @keyframes shineStat {
            0% { opacity: 0; }
            40% { opacity: 1; }
            100% { opacity: 0; }
        }
        .stat-card:hover {
            background: linear-gradient(120deg, rgba(67,97,238,0.18), rgba(255,158,0,0.13));
            transform: translateY(-4px) scale(1.045) rotate(-1deg);
            box-shadow: 0 4px 18px 0 rgba(67,97,238,0.16);
        }
        .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 0.05rem;
            background: linear-gradient(90deg, #ff9e00, #4361ee 80%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 1px 4px rgba(67,97,238,0.10));
        }
        .stat-value {
            font-size: 1.15rem;
            font-weight: 900;
            background: linear-gradient(135deg, #4361ee, #f72585 80%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
        }
        .stat-label {
            font-size: 0.85rem;
            opacity: 0.85;
            font-weight: 600;
            color: #fff;
            text-shadow: 0 1px 8px rgba(67,97,238,0.08);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .quick-action-btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .quick-action-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
        }

        .quick-action-btn.premium {
            background: var(--premium);
        }

        .section {
            padding: 3rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 3rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-title-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-icon {
            width: 60px;
            height: 60px;
            background: var(--premium);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: var(--shadow-light);
        }

        .section-title {
            font-size: 2.2rem;
            font-weight: 800;
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .live-badge {
            background: linear-gradient(45deg, var(--accent), #b5179e);
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .live-badge::before {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .view-toggle {
            display: flex;
            background: var(--glass);
            border-radius: 10px;
            padding: 0.3rem;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .view-toggle-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .view-toggle-btn.active {
            background: var(--primary);
            color: white;
        }

        .ads-carousel {
            position: relative;
            height: 400px;
            overflow: hidden;
            border-radius: 25px;
            margin-bottom: 4rem;
            box-shadow: var(--shadow-heavy);
            cursor: pointer;
        }

        .ad-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 3rem;
            opacity: 0;
        }

        .ad-slide.active {
            opacity: 1;
        }

        .ad-slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                135deg,
                rgba(0,0,0,0.1) 0%,
                rgba(0,0,0,0.3) 40%,
                rgba(0,0,0,0.8) 100%
            );
        }

        .ad-content {
            position: relative;
            z-index: 2;
            max-width: 600px;
        }

        .ad-badge {
            background: var(--accent);
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: inline-block;
            font-weight: 700;
        }

        .ad-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .ad-desc {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .ad-link {
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-radius: 50px;
            text-decoration: none;
            color: white;
            font-weight: 600;
            border: 1px solid var(--glass-border);
        }

        .ad-link:hover {
            background: var(--primary);
        }

        .carousel-indicators {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.8rem;
            z-index: 3;
        }

        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
        }

        .carousel-indicator.active {
            background: white;
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 3;
        }

        .carousel-nav:hover {
            background: var(--primary);
            transform: translateY(-50%) scale(1.1);
        }

        .carousel-nav.prev {
            left: 2rem;
        }

        .carousel-nav.next {
            right: 2rem;
        }

        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .channel-card {
            display: flex;
            flex-direction: column;
            height: 350px;
            border-radius: 22px;
            overflow: hidden;
            box-shadow: 0 6px 24px 0 rgba(67,97,238,0.13), 0 1.5px 8px 0 #7c3aed22;
            border: 2.5px solid #ff9e00;
            background: linear-gradient(135deg, #23243a 70%, #2d2533 100%);
            transition: box-shadow 0.25s, transform 0.22s, border-color 0.22s;
            position: relative;
            min-width: 220px;
            max-width: 100%;
        }
        .channel-card:hover {
            transform: translateY(-8px) scale(1.035);
            box-shadow: 0 12px 32px 0 #ff9e0033, 0 0 32px 0 #7c3aed33;
            border-color: #7c3aed;
        }
        .channel-header {
            position: relative;
            width: 100%;
            height: 140px;
            background: #18192a;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 18px 18px 0 0;
        }
        .channel-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #222;
            display: block;
            transition: transform 0.4s;
        }
        .channel-card:hover .channel-image {
            transform: scale(1.07) rotate(-1deg);
        }
        .channel-badges {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: row;
            gap: 7px;
            z-index: 2;
        }
        .channel-badge {
            padding: 0.18rem 0.8rem;
            border-radius: 16px;
            font-size: 0.92rem;
            font-weight: 800;
            color: #fff;
            background: #ff9e00;
            box-shadow: 0 2px 8px #0002;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            opacity: 0.97;
            margin-bottom: 0;
            letter-spacing: 0.5px;
        }
        .channel-badge.live { background: linear-gradient(45deg, #f72585, #b5179e); }
        .channel-badge.hd, .channel-badge.fhd, .channel-badge.k4 { background: linear-gradient(45deg, #4cc9f0, #06d6a0); }
        .channel-badge.premium { background: linear-gradient(135deg, #ff9e00, #ff6b35); }
        .channel-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 1.2rem 1.1rem 1.1rem 1.1rem;
            margin-top: 0;
        }
        .channel-name-row {
            font-size: 1.22rem;
            font-weight: 900;
            margin-bottom: 0.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #fff;
        }
        .channel-category-row {
            margin-bottom: 0.2rem;
        }
        .channel-category {
            background: #393e5c;
            color: #fff;
            border-radius: 20px;
            padding: 0.18rem 0.9rem;
            font-size: 0.93rem;
            font-weight: 700;
            display: inline-block;
            letter-spacing: 0.2px;
        }
        .channel-rating-row {
            color: #ffb700;
            font-size: 1.05rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        .channel-actions {
            display: flex;
            gap: 0.7rem;
            margin-top: 1.1rem;
        }
        .channel-action-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.7rem 0.5rem;
            border-radius: 12px;
            background: var(--glass);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.01rem;
            font-weight: 700;
            border: 1.5px solid var(--glass-border);
            color: #fff;
        }
        .channel-action-btn:hover {
            background: var(--primary);
            color: #fff;
            transform: translateY(-2px) scale(1.04);
        }
        .channel-action-btn.play-btn {
            background: var(--premium);
            flex: 2;
            color: #fff;
            font-weight: 900;
        }
        .channel-action-btn.play-btn:hover {
            background: linear-gradient(135deg, var(--warning), #ff6b35);
        }
        .channel-action-btn.favorite.active {
            background: var(--accent);
            color: white;
        }
        /* تحسين الاستجابة */
        @media (max-width: 900px) {
            .channel-card { min-width: 180px; height: 320px; }
            .channel-header { height: 110px; }
            .channel-content { padding: 0.8rem 0.7rem 0.7rem 0.7rem; }
            .channel-name-row { font-size: 1.05rem; }
        }
        @media (max-width: 600px) {
            .channel-card { min-width: unset; max-width: 100%; height: auto; border-radius: 14px; }
            .channel-header { height: 90px; border-radius: 14px 14px 0 0; }
            .channel-content { padding: 0.7rem 0.4rem 0.7rem 0.4rem; }
            .channel-name-row { font-size: 0.98rem; }
            .channel-category { font-size: 0.85rem; }
            .channel-badge { font-size: 0.82rem; padding: 0.13rem 0.6rem; }
        }
        .channel-badges {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .channel-badge {
            background: var(--premium);
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 700;
            backdrop-filter: blur(10px);
        }

        .channel-badge.live {
            background: linear-gradient(45deg, var(--accent), #b5179e);
        }

        .channel-badge.premium {
            background: var(--premium);
        }

        .channel-badge.hd {
            background: linear-gradient(45deg, var(--success), #06d6a0);
        }

        .channel-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 60%, rgba(0,0,0,0.8));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
        }

        .channel-card:hover .channel-overlay {
            opacity: 1;
        }

        .play-overlay {
            width: 80px;
            height: 80px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            border: 2px solid var(--glass-border);
        }

        .play-overlay:hover {
            background: var(--primary);
        }

        .channel-content {
            padding: 2rem;
        }

        .channel-name {
            font-size: 1.4rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 700;
        }

        .channel-category {
            background: rgba(67, 97, 238, 0.2);
            padding: 0.3rem 1rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .channel-desc {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .channel-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .channel-actions {
            display: flex;
            gap: 0.8rem;
        }

        .channel-action-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.8rem;
            border-radius: 12px;
            background: var(--glass);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            border: 1px solid var(--glass-border);
        }

        .channel-action-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        .channel-action-btn.play-btn {
            background: var(--premium);
            flex: 2;
        }

        .channel-action-btn.play-btn:hover {
            background: linear-gradient(135deg, var(--warning), #ff6b35);
        }

        .channel-action-btn.favorite.active {
            background: var(--accent);
            color: white;
        }

        .filters-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--glass);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .filter-select {
            background: transparent;
            border: none;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            min-width: 120px;
        }

        .filter-select option {
            background: var(--darker);
            color: white;
        }

        .sort-toggle {
            display: flex;
            gap: 0.3rem;
            background: var(--glass);
            padding: 0.3rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .sort-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .sort-btn.active {
            background: var(--primary);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--gradient-card);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
            padding: 3rem;
            box-shadow: var(--shadow-heavy);
            position: relative;
            border: 1px solid var(--glass-border);
        }

        .close-modal {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--accent);
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--glass);
        }

        .close-modal:hover {
            background: var(--accent);
            color: white;
        }

        .modal-title {
            text-align: center;
            margin-bottom: 2.5rem;
            font-size: 2.2rem;
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .input-group {
            margin-bottom: 2rem;
            position: relative;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-size: 1rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .input-group input {
            width: 100%;
            padding: 1rem 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .modal-btn {
            width: 100%;
            padding: 1.2rem;
            border-radius: 15px;
            border: none;
            background: var(--premium);
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
            background: linear-gradient(135deg, var(--warning), #ff6b35);
        }

        .modal-footer {
            text-align: center;
            margin-top: 2rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .modal-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .modal-footer a:hover {
            color: var(--accent);
        }

        .video-player {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.98);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }
        .video-player.show {
            display: flex;
            opacity: 1;
        }
        #player {
            width: 90vw;
            max-width: 900px;
            height: 60vh;
            max-height: 80vh;
            background: black;
            border-radius: 18px;
            box-shadow: 0 8px 40px #000a;
        }
        .player-info {
            position: absolute;
            top: 3.5rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 2.2rem 3.2rem;
            border-radius: 22px;
            border: 2.5px solid var(--glass-border);
            z-index: 3001;
            font-size: 2.1rem;
            min-width: 320px;
            max-width: 90vw;
            box-shadow: 0 8px 40px #000a;
        }
        .player-title {
            font-size: 2.1rem;
            font-weight: 900;
            margin-bottom: 0.7rem;
        }
        .player-category {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.8);
        }
        .player-controls {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            right: auto;
            bottom: auto;
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 0.7rem;
            z-index: 3001;
        }
        .player-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--glass);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
            box-shadow: 0 2px 8px #0002;
        }
        .player-btn:hover {
            background: var(--primary);
        }
        @media (max-width: 600px) {
          .player-controls {
            top: 0.7rem;
            left: 0.7rem;
            gap: 0.3rem;
          }
          .player-btn {
            width: 38px;
            height: 38px;
            font-size: 1rem;
          }
        }
        .toast-container {
            position: fixed;
            top: 32px;
            left: 50%;
            transform: translateX(-50%, 0);
            z-index: 99999 !important;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            min-width: 340px;
            max-width: 95vw;
            pointer-events: none;
        }
        .toast {
            pointer-events: auto;
            background: rgba(20,20,30,0.97);
            color: #fff;
            border-radius: 22px;
            box-shadow: 0 8px 40px 0 #0008, 0 1.5px 8px 0 #7c3aed33;
            font-size: 1.25rem;
            font-weight: 700;
            padding: 2.2rem 2.5rem 2.2rem 2.5rem;
            min-width: 320px;
            max-width: 95vw;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 1.2rem;
            border: 2.5px solid #4ecdc4;
            position: relative;
            opacity: 0;
        }
        .toast.show {
            opacity: 1;
        }
        .toast-icon {
            font-size: 2.5rem !important;
            margin-left: 1rem;
            flex-shrink: 0;
        }
        .toast-close {
            position: absolute;
            top: 12px;
            left: 12px;
            font-size: 1.3rem;
            color: #fff;
            opacity: 0.7;
            cursor: pointer;
        }
        .toast-close:hover { opacity: 1; }
        .toast-message {
            font-size: 1.15rem;
            font-weight: 700;
            line-height: 1.7;
            text-align: center;
            flex: 1;
        }
        .toast-title {
            font-weight: 700;
            margin-bottom: 0.2rem;
        }
        .toast-message {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .toast-close {
            cursor: pointer;
            opacity: 0.6;
        }
        .toast-close:hover {
            opacity: 1;
        }
        .toast.success {
            border-color: var(--success);
        }
        .toast.error {
            border-color: var(--danger);
        }
        .toast.warning {
            border-color: var(--warning);
        }
        .toast-title {
            font-weight: 700;
            margin-bottom: 0.2rem;
        }
        .toast-message {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .toast-close {
            cursor: pointer;
            opacity: 0.6;
        }
        .toast-close:hover {
            opacity: 1;
        }
        footer {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 4rem 2rem 2rem;
            margin-top: 6rem;
            border-top: 1px solid var(--glass-border);
            position: relative;
        }
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 3rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        .footer-col h3 {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            font-weight: 800;
        }
        .footer-col p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        .footer-links {
            list-style: none;
        }
        .footer-links li {
            margin-bottom: 1rem;
        }
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 0;
            font-weight: 500;
        }
        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(10px);
        }
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        .social-link {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--glass);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
            text-decoration: none;
            color: white;
        }
        .social-link:hover {
            background: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow-light);
        }
        .newsletter-form {
            display: flex;
            margin-top: 1.5rem;
            gap: 0.5rem;
        }
        .newsletter-input {
            flex: 1;
            padding: 1rem;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            background: var(--glass);
            color: white;
            backdrop-filter: blur(10px);
        }
        .newsletter-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        .newsletter-btn {
            background: var(--primary);
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }
        .newsletter-btn:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }
        .copyright {
            text-align: center;
            padding-top: 3rem;
            margin-top: 3rem;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        @media (max-width: 1200px) {
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
        @media (max-width: 992px) {
            .section {
                padding: 2rem 1rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .welcome-title {
                font-size: 2.5rem;
            }
        }
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                width: 100%;
            }
            
            .hero {
                padding: 2rem 1rem;
            }
            
            .welcome-card {
                padding: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .ad-slide {
                padding: 2rem 1rem;
            }
            
            .ad-title {
                font-size: 2rem;
            }
            
            .filters-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .channels-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                margin: 1rem;
                padding: 2rem;
            }
        }
        @media (max-width: 480px) {
            .logo-text {
                font-size: 1.5rem;
            }
            
            .nav-link {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .welcome-title {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .quick-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .quick-action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .toast {
                min-width: auto;
                margin: 0 1rem;
            }
        }
        .fade-in, .slide-in-left, .slide-in-right, .loading-skeleton, .tab-content, .tab-content.active {
            animation: none !important;
            transition: none !important;
        }
        @keyframes backgroundShift {}
        @keyframes pulse {}
        @keyframes spin {}
        @keyframes shine {}
        @keyframes heroRotate {}
        @keyframes shineAnim {}
        @keyframes cardPopIn {}
        @keyframes bgMove {}
        @keyframes shineStat {}
        @keyframes blink {}
        @keyframes fadeIn {}
        @keyframes slideInLeft {}
        @keyframes slideInRight {}
        @keyframes loading {}
        @keyframes tabFadeIn {}
        .loading-skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.1) 25%, 
                rgba(255,255,255,0.2) 50%, 
                rgba(255,255,255,0.1) 75%
            );
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .skeleton-card {
            background: var(--glass);
            border-radius: 25px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .skeleton-header {
            height: 200px;
            border-radius: 20px;
            margin-bottom: 1rem;
        }
        .skeleton-title {
            height: 24px;
            width: 70%;
            border-radius: 12px;
            margin-bottom: 0.5rem;
        }
        .skeleton-text {
            height: 16px;
            width: 90%;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        .skeleton-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .skeleton-btn {
            flex: 1;
            height: 40px;
            border-radius: 10px;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes tabFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            margin-top: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
        }
        .search-result-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .search-result-item:hover {
            background: rgba(67, 97, 238, 0.2);
        }
        .search-result-item:last-child {
            border-bottom: none;
        }
        .search-result-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .search-result-content {
            flex: 1;
        }
        .search-result-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }
        .search-result-category {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }
        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: rgba(255, 255, 255, 0.6);
        }
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 2rem;
            color: rgba(255, 255, 255, 0.3);
        }
        .empty-state-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }
        .empty-state-message {
            font-size: 1rem;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto;
        }
        .text-gradient {
            background: var(--premium);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .glass-bg {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }
        .premium-bg {
            background: var(--premium);
        }
        .shadow-light {
            box-shadow: var(--shadow-light);
        }
        .shadow-medium {
            box-shadow: var(--shadow-medium);
        }
        .shadow-heavy {
            box-shadow: var(--shadow-heavy);
        }
        .rounded-xl {
            border-radius: 20px;
        }
        .rounded-2xl {
            border-radius: 25px;
        }
        .rounded-3xl {
            border-radius: 30px;
        }
        .news-filters {
            display: flex;
            gap: 1.2rem;
            margin-bottom: 2rem;
            justify-content: center;
            align-items: center;
        }
        .news-filter-btn {
            background: var(--glass);
            border: 2px solid var(--glass-border);
            color: var(--primary);
            font-weight: 800;
            font-size: 1.08rem;
            border-radius: 50px;
            padding: 0.7rem 2.2rem;
            cursor: pointer;
            box-shadow: 0 2px 12px rgba(67,97,238,0.07);
            outline: none;
            position: relative;
        }
        .news-filter-btn.active, .news-filter-btn:focus {
            background: var(--premium);
            color: #fff;
            border-color: var(--primary);
            box-shadow: 0 4px 18px 0 #ff9e0033, 0 0 12px 0 #7c3aed33;
            z-index: 2;
        }
        .news-filter-btn:hover:not(.active) {
            background: var(--primary);
            color: #fff;
            border-color: var(--accent);
        }
        @media (max-width: 600px) {
          .channels-grid,
          .news-cards-grid,
          #categoriesContent {
            grid-template-columns: 1fr !important;
            gap: 1rem !important;
            padding: 0 !important;
          }
          .channel-card, .news-card {
            min-width: unset !important;
            max-width: 100% !important;
            width: 100% !important;
            height: auto !important;
            border-radius: 18px !important;
            box-shadow: 0 2px 10px 0 rgba(67,97,238,0.10) !important;
            margin: 0 auto 1rem auto !important;
            padding: 0.7rem 0.5rem !important;
          }
          .channel-header {
            height: 120px !important;
            min-height: 100px !important;
            border-radius: 18px 18px 0 0 !important;
          }
          .channel-image {
            height: 100% !important;
            border-radius: 18px 18px 0 0 !important;
          }
          .channel-content {
            padding: 1rem 0.5rem 0.7rem 0.5rem !important;
          }
          .channel-name {
            font-size: 1.05rem !important;
            margin-bottom: 0.4rem !important;
          }
          .channel-desc {
            font-size: 0.9rem !important;
            margin-bottom: 0.7rem !important;
          }
          .channel-actions {
            gap: 0.4rem !important;
          }
          .stat-card {
            min-width: 80px !important;
            max-width: 100px !important;
            padding: 0.7rem 0.5rem 0.5rem 0.5rem !important;
            border-radius: 10px !important;
          }
          .welcome-card {
            min-width: unset !important;
            max-width: 100% !important;
            padding: 1.2rem 0.5rem 1rem 0.5rem !important;
            border-radius: 18px !important;
          }
          .welcome-title {
            font-size: 1.2rem !important;
          }
          .welcome-subtitle {
            font-size: 0.95rem !important;
          }
          .section-header {
            flex-direction: column !important;
            align-items: flex-start !important;
            gap: 0.5rem !important;
            margin-bottom: 1.2rem !important;
          }
          .section-title {
            font-size: 1.2rem !important;
          }
          .section-icon {
            width: 38px !important;
            height: 38px !important;
            font-size: 1.1rem !important;
            border-radius: 10px !important;
          }
          .quick-actions {
            flex-direction: column !important;
            gap: 0.5rem !important;
            margin-top: 1rem !important;
          }
          .quick-action-btn {
            width: 100% !important;
            padding: 0.7rem 0.5rem !important;
            font-size: 0.95rem !important;
            border-radius: 12px !important;
          }
          header {
            flex-direction: column !important;
            gap: 0.7rem !important;
            padding: 0.5rem !important;
            min-height: unset !important;
          }
          .logo-icon {
            width: 38px !important;
            height: 38px !important;
            font-size: 1rem !important;
            border-radius: 10px !important;
          }
          .logo-text {
            font-size: 1.1rem !important;
          }
          .nav-links {
            flex-wrap: wrap !important;
            gap: 0.2rem !important;
            padding: 0.2rem !important;
          }
          .nav-link {
            padding: 0.4rem 0.7rem !important;
            font-size: 0.9rem !important;
            border-radius: 20px !important;
          }
          .user-actions {
            gap: 0.5rem !important;
          }
          .action-btn, .user-avatar {
            width: 36px !important;
            height: 36px !important;
            font-size: 1rem !important;
            border-radius: 50% !important;
          }
          .footer-grid {
            grid-template-columns: 1fr !important;
            gap: 1.2rem !important;
            padding: 0 !important;
          }
          footer {
            padding: 1.5rem 0.5rem 1rem 0.5rem !important;
            margin-top: 2rem !important;
          }
          .footer-col h3 {
            font-size: 1.1rem !important;
            margin-bottom: 1rem !important;
          }
          .footer-col p, .footer-links a {
            font-size: 0.95rem !important;
          }
          .newsletter-form {
            flex-direction: column !important;
            gap: 0.3rem !important;
          }
          .newsletter-input, .newsletter-btn {
            width: 100% !important;
            padding: 0.7rem !important;
            font-size: 0.95rem !important;
            border-radius: 10px !important;
          }
          .modal-content {
            padding: 1rem !important;
            border-radius: 14px !important;
            max-width: 98vw !important;
          }
          .modal-title {
            font-size: 1.1rem !important;
          }
          .input-group input {
            padding: 0.7rem 1rem !important;
            font-size: 0.95rem !important;
            border-radius: 10px !important;
          }
          .modal-btn {
            padding: 0.8rem !important;
            font-size: 1rem !important;
            border-radius: 10px !important;
          }
          .player-info {
            top: 0.5rem !important;
            left: 0.5rem !important;
            padding: 0.5rem 0.7rem !important;
            border-radius: 10px !important;
          }
          .player-title {
            font-size: 1rem !important;
          }
          .player-controls {
            bottom: 0.7rem !important;
            gap: 0.7rem !important;
          }
          .player-btn {
            width: 38px !important;
            height: 38px !important;
            font-size: 1rem !important;
            border-radius: 50% !important;
          }
          .empty-state {
            padding: 2rem 0.5rem !important;
          }
          .empty-state-icon {
            font-size: 2.2rem !important;
          }
          .toast {
            min-width: unset !important;
            padding: 0.7rem 1rem !important;
            border-radius: 10px !important;
            font-size: 0.95rem !important;
          }
          .news-filters {
            gap: 0.5rem !important;
            flex-wrap: wrap !important;
            margin-bottom: 1rem !important;
          }
          .news-filter-btn {
            padding: 0.5rem 1rem !important;
            font-size: 0.95rem !important;
            border-radius: 20px !important;
          }
        }
        @media (max-width: 400px) {
          .channels-grid,
          .news-cards-grid,
          #categoriesContent {
            grid-template-columns: 1fr !important;
          }
          .channel-card, .news-card {
            padding: 0.3rem 0.1rem !important;
            border-radius: 10px !important;
          }
          .welcome-card {
            padding: 0.5rem 0.1rem 0.5rem 0.1rem !important;
            border-radius: 10px !important;
          }
          .modal-content {
            padding: 0.5rem !important;
            border-radius: 8px !important;
          }
        }
        .notifications-dropdown {
          min-width: 320px;
          animation: fadeIn 0.3s;
        }
        @media (max-width: 600px) {
          .notifications-dropdown {
            min-width: 95vw;
            left: 2.5vw !important;
            right: 2.5vw !important;
          }
        }
        .notification-item {
          padding: 1rem 1.2rem 0.7rem;
          border-bottom: 1px solid var(--glass-border);
          cursor: pointer;
          transition: background 0.2s;
          position: relative;
        }
        .notification-item.unread {
          background: rgba(247,37,133,0.08);
        }
        .notification-item:last-child {
          border-bottom: none;
        }
        .notification-title {
          font-weight: 800;
          font-size: 1.05rem;
          margin-bottom: 0.3rem;
        }
        .notification-content {
          font-size: 0.95rem;
          opacity: 0.85;
          margin-bottom: 0.2rem;
        }
        .notification-date {
          font-size: 0.85rem;
          opacity: 0.7;
          text-align: left;
        }
        .notification-type-badge {
          display: inline-block;
          font-size: 0.8rem;
          border-radius: 8px;
          padding: 0.1rem 0.7rem;
          margin-left: 0.5rem;
          color: #fff;
          background: var(--primary);
        }
        .notification-type-badge.urgent { background: var(--danger); }
        .notification-type-badge.warning { background: var(--warning); }
        .notification-type-badge.update { background: var(--success); }
        .notification-type-badge.promotion { background: var(--accent); }
        .ads-carousel .ad-slide {
          border: 3px solid #ff9e00 !important;
          border-radius: 25px !important;
          box-sizing: border-box;
        }
        
        .channel-card {
          border: 3px solid #ff9e00 !important;
          border-radius: 25px !important;
          box-sizing: border-box;
        }
        .channel-card, .news-card, .stat-card, .welcome-card, .skeleton-card, .ads-carousel .ad-slide {
          border: 3px solid #7c3aed;
          border-radius: 32px !important;
          box-sizing: border-box;
        }
        .video-player.show #player,
        .video-player #player {
          width: 100vw !important;
          height: 100vh !important;
          max-width: none !important;
          max-height: none !important;
          border-radius: 0 !important;
          background: black;
          box-shadow: none !important;
          display: block;
        }
        .welcome-card {
            max-width: 480px;
            min-width: 260px;
            padding: 1.2rem 1.5rem 1.2rem 1.5rem;
            min-height: 180px;
        }
        .stat-card {
            min-width: 140px;
            max-width: 200px;
            padding: 2rem 1.5rem 1.5rem 1.5rem;
        }
        .stat-icon {
            font-size: 2.2rem;
        }
        .stat-value {
            font-size: 1.7rem;
        }
        .stat-label {
            font-size: 1.1rem;
        }
        .user-avatar[disabled], .user-avatar.disabled {
            pointer-events: none !important;
            opacity: 0.5 !important;
            filter: grayscale(0.7);
        }
        .action-btn#searchBtn {
            margin: 0 0.7rem !important;
        }
        .user-avatar[disabled], .user-avatar.disabled, #loginBtn.disabled {
            pointer-events: none !important;
            opacity: 0.5 !important;
            filter: grayscale(0.7);
        }
        .channel-name-row {
          font-size: 1.18rem;
          font-weight: 800;
          margin-bottom: 0.3rem;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }
        .channel-category-row {
          margin-bottom: 0.3rem;
        }
        .channel-category {
          background: #393e5c;
          color: #fff;
          border-radius: 20px;
          padding: 0.2rem 0.9rem;
          font-size: 0.85rem;
          font-weight: 700;
          display: inline-block;
        }
        .channel-rating-row {
          color: #aaa;
          font-size: 0.95rem;
          margin-bottom: 0.5rem;
        }
    </style>
    <script>
    </script>
</head>
<body>
    <div class="page-loader" id="pageLoader">
        <div class="loader-content">
            <div class="loader-logo">
                <svg width="60" height="60" viewBox="0 0 213 263" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_879_4834)">
<path d="M43.8515 234.156V240.201H32.6597V261.04H22.9324V240.201H11.793V234.156H43.8515ZM80.4307 234.156L68.2453 261.04H57.0012L45.1296 234.156H55.38L58.7794 241.966C60.697 246.347 62.0218 250.402 62.754 254.131C63.5559 250.377 64.8982 246.334 66.7809 242.004L70.1803 234.156H80.4307ZM126.588 234.156V261.04H116.808V249.926H104.1V261.04H94.3201V234.156H104.1V243.881H116.808V234.156H126.588ZM165.971 234.156V250.151C165.971 253.731 164.942 256.409 162.885 258.186C160.166 260.539 155.773 261.716 149.706 261.716C143.256 261.716 138.671 260.389 135.952 257.736C134.243 256.059 133.389 253.506 133.389 250.076V234.156H143.169V250.602C143.169 252.479 143.692 253.843 144.738 254.695C145.818 255.521 147.544 255.934 149.915 255.934C152.112 255.934 153.715 255.521 154.727 254.695C155.738 253.843 156.243 252.479 156.243 250.602V234.156H165.971ZM172.843 234.156H190.833C194.494 234.156 197.266 234.494 199.148 235.17C202.356 236.321 203.96 238.236 203.96 240.915C203.96 243.343 202.321 245.158 199.044 246.359C200.508 246.735 201.589 247.123 202.286 247.523C204.587 248.775 205.738 250.602 205.738 253.005C205.738 255.984 204.064 258.199 200.717 259.651C198.591 260.577 195.679 261.04 191.984 261.04H172.843V234.156ZM182.622 239.525V244.745H189.578C192.82 244.745 194.442 243.881 194.442 242.154C194.442 240.402 192.733 239.525 189.316 239.525H182.622ZM182.622 249.325V255.521H190.31C194.006 255.521 195.854 254.494 195.854 252.442C195.854 250.364 193.936 249.325 190.101 249.325H182.622Z" fill="#5E5E5E"/>
</g>
<g clip-path="url(#clip1_879_4834)">
<path d="M40.0976 231.652V237.697H28.9058V258.536H19.1785V237.697H8.03906V231.652H40.0976ZM76.6768 231.652L64.4914 258.536H53.2473L41.3757 231.652H51.6261L55.0255 239.462C56.9431 243.843 58.2679 247.898 59.0001 251.627C59.802 247.873 61.1443 243.83 63.027 239.5L66.4264 231.652H76.6768ZM122.834 231.652V258.536H113.054V247.422H100.346V258.536H90.5662V231.652H100.346V241.377H113.054V231.652H122.834ZM162.217 231.652V247.647C162.217 251.227 161.188 253.905 159.131 255.683C156.412 258.035 152.019 259.212 145.952 259.212C139.502 259.212 134.917 257.885 132.198 255.232C130.489 253.555 129.635 251.002 129.635 247.572V231.652H139.415V248.098C139.415 249.975 139.938 251.34 140.984 252.191C142.065 253.017 143.79 253.43 146.161 253.43C148.358 253.43 149.962 253.017 150.973 252.191C151.984 251.34 152.489 249.975 152.489 248.098V231.652H162.217ZM169.089 231.652H187.079C190.74 231.652 193.512 231.99 195.394 232.666C198.602 233.818 200.206 235.732 200.206 238.411C200.206 240.839 198.567 242.654 195.29 243.855C196.754 244.231 197.835 244.619 198.532 245.019C200.833 246.271 201.984 248.098 201.984 250.501C201.984 253.48 200.31 255.695 196.963 257.147C194.837 258.073 191.925 258.536 188.23 258.536H169.089V231.652ZM178.868 237.022V242.241H185.824C189.066 242.241 190.688 241.377 190.688 239.65C190.688 237.898 188.979 237.022 185.562 237.022H178.868ZM178.868 246.821V253.017H186.556C190.252 253.017 192.1 251.99 192.1 249.938C192.1 247.86 190.182 246.821 186.347 246.821H178.868Z" fill="#FF6500"/>
</g>
<path d="M208.5 105.5C208.5 161.241 162.873 206.5 106.5 206.5C50.1268 206.5 4.5 161.241 4.5 105.5C4.5 49.7592 50.1268 4.5 106.5 4.5C162.873 4.5 208.5 49.7592 208.5 105.5Z" stroke="#FF6500" stroke-width="9"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M178 92.5C178 136.407 141.959 172 97.5 172C53.0411 172 17 136.407 17 92.5C17 48.5934 53.0411 13 97.5 13C141.959 13 178 48.5934 178 92.5ZM129 59.5C129 67.5081 122.508 74 114.5 74C106.492 74 100 67.5081 100 59.5C100 51.4919 106.492 45 114.5 45C122.508 45 129 51.4919 129 59.5ZM70.5 81C78.5081 81 85 74.5081 85 66.5C85 58.4919 78.5081 52 70.5 52C62.4919 52 56 58.4919 56 66.5C56 74.5081 62.4919 81 70.5 81ZM78 110.5C78 118.508 71.5081 125 63.5 125C55.4919 125 49 118.508 49 110.5C49 102.492 55.4919 96 63.5 96C71.5081 96 78 102.492 78 110.5ZM103.5 145C111.508 145 118 138.508 118 130.5C118 122.492 111.508 116 103.5 116C95.4919 116 89 122.492 89 130.5C89 138.508 95.4919 145 103.5 145ZM149 98.5C149 106.508 142.508 113 134.5 113C126.492 113 120 106.508 120 98.5C120 90.4919 126.492 84 134.5 84C142.508 84 149 90.4919 149 98.5ZM97.5 97C99.9853 97 102 94.9853 102 92.5C102 90.0147 99.9853 88 97.5 88C95.0147 88 93 90.0147 93 92.5C93 94.9853 95.0147 97 97.5 97Z" fill="url(#paint0_radial_879_4834)"/>
<defs>
<radialGradient id="paint0_radial_879_4834" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(97.5 92.5) rotate(90) scale(79.5 80.5)">
<stop stop-color="#EC8305"/>
<stop offset="1" stop-color="#FF6500"/>
</radialGradient>
<clipPath id="clip0_879_4834">
<rect width="195.245" height="28.7862" fill="white" transform="translate(10.7539 233.504)"/>
</clipPath>
<clipPath id="clip1_879_4834">
<rect width="195.245" height="28.7862" fill="white" transform="translate(7 231)"/>
</clipPath>
</defs>
</svg>
            </div>
            <div class="loader-text">مرحباً بك </div>
            <div class="loader-spinner"></div>
        </div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        <div style="display: flex; align-items: center; gap: 10px;">
            <div class="loading-spinner"></div>
            <span>جاري الاتصال ...</span>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <header id="header">
        <div class="logo" id="homeBtn">
            <h1 class="logo-text">TV HUB</h1>
        </div>
        
        <nav class="nav-links">
            <div class="nav-link active" data-tab="home">
                <i class="fas fa-home"></i>
                الرئيسية
            </div>
            <div class="nav-link" data-tab="channels">
                <i class="fas fa-tv"></i>
                القنوات
            </div>
            <div class="nav-link" data-tab="categories">
                <i class="fas fa-list"></i>
الأقسام            </div>
            <div class="nav-link" data-tab="favorites">
                <i class="fas fa-heart"></i>
                المفضلة
            </div>
            <div class="nav-link" data-tab="news">
                <i class="fas fa-newspaper"></i>
                الأخبار
            </div>
        </nav>
        
        <div class="user-actions">
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="ابحث عن القنوات...">
                <div class="action-btn" id="searchBtn">
                    <i class="fas fa-search"></i>
                </div>
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="user-avatar" id="loginBtn">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <main id="mainContent">
        <section id="homeTab" class="tab-content active">
            <div class="hero">
                <div class="welcome-card fade-in">
                    <h2 class="welcome-title" id="welcomeTitle">Welcome to TV HUB</h2>
                    <p class="welcome-subtitle" id="welcomeSubtitle">استمتع بأفضل تجربة مشاهدة للقنوات المحلية والعالمية</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card slide-in-left">
                            <div class="stat-icon">
                                <i class="fas fa-tv"></i>
                            </div>
                            <div class="stat-value" id="channelsCount">0</div>
                            <div class="stat-label">قناة تلفزيونية</div>
                        </div>
                        
                        <div class="stat-card slide-in-right">
                            <div class="stat-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-value" id="favoritesCount">0</div>
                            <div class="stat-label">قناة مفضلة</div>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <div class="quick-action-btn" data-tab="channels">
                            <i class="fas fa-play"></i>
                            <span>تصفح القنوات</span>
                        </div>
                        <div class="quick-action-btn" data-tab="news">
                            <i class="fas fa-newspaper"></i>
                            <span>آخر الأخبار</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                        <h2 class="section-title">TV HUB</h2>
                    </div>
                    <div class="section-controls">
                        <div class="live-badge">مباشر</div>
                    </div>
                </div>
                
                <div class="ads-carousel" id="adsCarousel">
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h2 class="section-title">القنوات المميزة</h2>
                    </div>
                    <div class="section-controls">
                        <div class="view-toggle">
                            <div class="view-toggle-btn active" data-view="grid">
                                <i class="fas fa-th"></i>
                            </div>
                            <div class="view-toggle-btn" data-view="list">
                                <i class="fas fa-list"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="channels-grid" id="featuredChannels">
                </div>
            </div>
        </section>

        <section id="channelsTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-tv"></i>
                        </div>
                        <h2 class="section-title">جميع القنوات</h2>
                    </div>
                    <div class="section-controls">
                        <div class="view-toggle">
                            <div class="view-toggle-btn active" data-view="grid">
                                <i class="fas fa-th"></i>
                            </div>
                            <div class="view-toggle-btn" data-view="list">
                                <i class="fas fa-list"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="filters-container">
                    <div class="filter-group">
                        <i class="fas fa-filter"></i>
                        <select class="filter-select" id="categoryFilter">
                            <option value="">جميع الأقسام</option>
                        </select>
                    </div>
                    
                </div>
                
                <div class="channels-grid" id="allChannels">
                </div>
            </div>
        </section>

        <section id="categoriesTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-list"></i>
                        </div>
                        <h2 class="section-title">الأقسام</h2>
                    </div>
                </div>
                
                <div class="channels-grid" id="categoriesContent">
                </div>
            </div>
        </section>

        <section id="favoritesTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h2 class="section-title">قنواتي المفضلة</h2>
                    </div>
                    <div class="section-controls">
                        <div class="quick-action-btn" id="clearFavoritesBtn">
                            <i class="fas fa-trash"></i>
                            <span>مسح الكل</span>
                        </div>
                    </div>
                </div>
                
                <div class="channels-grid" id="favoritesContent">
                </div>
            </div>
        </section>

        <section id="newsTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-newspaper"></i>
                        </div>
                        <h2 class="section-title">آخر الأخبار العربية</h2>
                    </div>
                    <div class="section-controls">
                        <div class="live-badge">مباشر</div>
                    </div>
                </div>
                <div class="news-filters" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button class="news-filter-btn active" data-type="all">الكل</button>
                  <button class="news-filter-btn" data-type="sports">رياضة</button>
                  <button class="news-filter-btn" data-type="technology">تقنية</button>
                  <button class="news-filter-btn" data-type="general">عام</button>
                </div>
                <div class="news-cards-grid" id="newsCardsGrid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1.5rem;"></div>
            </div>
        </section>
    </main>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="close-modal" id="closeModal">
                <i class="fas fa-times"></i>
            </div>
            <h2 class="modal-title">تسجيل الدخول</h2>
            
            <div class="input-group">
                <label for="email">البريد الإلكتروني أو اسم المستخدم</label>
                <input type="text" id="email" placeholder="ادخل بريدك الإلكتروني أو اسم المستخدم">
            </div>
            
            <div class="input-group">
                <label for="password">كلمة المرور</label>
                <input type="password" id="password" placeholder="ادخل كلمة المرور">
            </div>
            
            <button class="modal-btn" id="submitLogin">دخول</button>
            
            <div class="modal-footer">
               
                </p>
            </div>
        </div>
    </div>

    <div class="video-player" id="videoPlayer">
        
        <video id="player" playsinline controls data-plyr-config='{"settings":["quality","speed","loop"],"speed":{"selected":1,"options":[0.5,1,1.5,2]},"quality":{"default":720,"options":[360,480,720,1080]}}'></video>
        
        <div class="player-controls">
            <div class="player-btn" id="playerFullscreen">
                <i class="fas fa-expand"></i>
            </div>
            <div class="player-btn" id="playerVolume">
                <i class="fas fa-volume-up"></i>
            </div>
            <div class="player-btn" id="closePlayer">
                <i class="fas fa-times"></i>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <h3>TV HUB</h3>
                <p>منصة تلفزيونية شاملة تقدم أفضل القنوات المحلية والعالمية، والأخبار الرياضية، والبرامج الحصرية بجودة عالية وتجربة مستخدم متميزة.</p>
                <div class="social-links">
            
                    </a>
                </div>
            </div>
            
            <div class="footer-col">
                <h3>روابط سريعة</h3>
                <ul class="footer-links">
                    <li><a href="#" data-tab="home"><i class="fas fa-arrow-left"></i> الرئيسية</a></li>
                    <li><a href="#" data-tab="channels"><i class="fas fa-arrow-left"></i> القنوات</a></li>
                    <li><a href="#" data-tab="categories"><i class="fas fa-arrow-left"></i> الأقسام</a></li>
                    <li><a href="#" data-tab="favorites"><i class="fas fa-arrow-left"></i> المفضلة</a></li>
                    <li><a href="#" data-tab="news"><i class="fas fa-arrow-left"></i> الأخبار</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3>الدعم الفني</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fas fa-arrow-left"></i> الأسئلة الشائعة</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> سياسة الخصوصية</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> شروط الاستخدام</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> اتصل بنا</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> الإبلاغ عن مشكلة</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> مركز المساعدة</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3>النشرة البريدية</h3>
                <p>اشترك في نشرتنا البريدية لتصلك آخر التحديثات والعروض الحصرية ومعلومات عن القنوات الجديدة</p>
                <form class="newsletter-form" id="newsletterForm">
                    <input type="email" class="newsletter-input" placeholder="بريدك الإلكتروني" required>
                    <button type="submit" class="newsletter-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
        
        <div class="copyright">
            <br>
            <small>  </small>
        </div>
    </footer>

    <script>
        class TvNaApp {
            constructor() {
                this.SUPABASE_URL = 'https://vpvvjascwgivdjyyhzwp.supabase.co';
                this.SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdnZqYXNjd2dpdmRqeXloendwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MDYxMjYsImV4cCI6MjA2NTM4MjEyNn0.6AR2-MG4x9ugNTXe9jUqx-IwGEtj1m6MCYwQkTsSbUQ';
                
                this.currentUser = null;
                this.channels = [];
                this.ads = [];
                this.categories = [];
                this.favorites = this.loadFavoritesFromStorage();
                this.currentTab = 'home';
                this.currentSort = 'name';
                this.currentFilters = {
                    category: '',
                    quality: '',
                    search: ''
                };
                this.isLoading = false;
                this.isConnected = false;
                
                this.elements = {
                    pageLoader: document.getElementById('pageLoader'),
                    connectionStatus: document.getElementById('connectionStatus'),
                    header: document.getElementById('header'),
                    loginBtn: document.getElementById('loginBtn'),
                    loginModal: document.getElementById('loginModal'),
                    closeModal: document.getElementById('closeModal'),
                    submitLogin: document.getElementById('submitLogin'),
                    videoPlayer: document.getElementById('videoPlayer'),
                    playerElement: document.getElementById('player'),
                    closePlayer: document.getElementById('closePlayer'),
                    homeBtn: document.getElementById('homeBtn'),
                    searchBtn: document.getElementById('searchBtn'),
                    searchInput: document.getElementById('searchInput'),
                    searchResults: document.getElementById('searchResults'),
                    navLinks: document.querySelectorAll('.nav-link'),
                    tabContents: document.querySelectorAll('.tab-content'),
                    toastContainer: document.getElementById('toastContainer')
                };
                
                this.notifications = [];
                this.lastNotifiedIds = [];
                
                this.init();
            }
            
            async init() {
                try {
                    this.setupEventListeners();
                    await this.testConnection();
                    await this.loadAllData();
                    this.checkUserSession();
                    this.hideLoader();
                    this.animateElements();
                } catch (error) {
                    console.error('Application initialization failed:', error);
                    this.showConnectionStatus('error', 'فشل في تحميل التطبيق');
                    this.showToast('خطأ في تحميل التطبيق', 'error');
                }
            }

            async supabaseRequest(endpoint, options = {}) {
                const url = `${this.SUPABASE_URL}/rest/v1/${endpoint}`;
                const headers = {
                    'apikey': this.SUPABASE_KEY,
                    'Authorization': `Bearer ${this.SUPABASE_KEY}`,
                    'Content-Type': 'application/json',
                    'Prefer': 'return=representation',
                    ...options.headers
                };

                try {
                    console.log(`Making request to: ${url}`, options);
                    
                    const response = await fetch(url, {
                        ...options,
                        headers
                    });

                    console.log(`Response status: ${response.status}`);

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('Supabase error:', errorText);
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }

                    const text = await response.text();
                    const result = text ? JSON.parse(text) : null;
                    console.log('Supabase response:', result);
                    return result;
                } catch (error) {
                    console.error('Supabase request error:', error);
                    throw error;
                }
            }

            async testConnection() {
                try {
                    this.showConnectionStatus('connecting', 'جاري اختبار الاتصال بقاعدة البيانات...');
                    
                    const result = await this.supabaseRequest('channels?limit=1');
                    
                    this.isConnected = true;
                    this.showConnectionStatus('connected', '✅ متصل بقاعدة البيانات بنجاح');
                    
                    setTimeout(() => {
                        this.hideConnectionStatus();
                    }, 3000);
                    
                } catch (error) {
                    console.error('Connection test failed:', error);
                    this.isConnected = false;
                    this.showConnectionStatus('error', '❌ فشل الاتصال بقاعدة البيانات - استخدام البيانات المحلية');
                    
                    setTimeout(() => {
                        this.hideConnectionStatus();
                    }, 5000);
                }
            }

            showConnectionStatus(type, message) {
                const statusElement = this.elements.connectionStatus;
                statusElement.className = `connection-status ${type} show`;
                statusElement.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        ${type === 'connecting' ? '<div class="loading-spinner"></div>' : ''}
                        <span>${message}</span>
                    </div>
                `;
            }

            hideConnectionStatus() {
                this.elements.connectionStatus.classList.remove('show');
            }

            async loadAllData() {
                try {
                    this.isLoading = true;
                    
                    await Promise.all([
                        this.loadChannelsFromDB(),
                        this.loadCategoriesFromDB(),
                        this.loadAdsFromDB()
                    ]);
                    
                    this.updateStats();
                    this.renderAds();
                    this.renderFeaturedChannels();
                    this.renderAllChannels();
                    this.populateFilters();
                    
                    this.isLoading = false;
                    
                } catch (error) {
                    console.error('Error loading data:', error);
                    this.isLoading = false;
                    
                    this.loadMockData();
                    this.showToast('تم تحميل البيانات التجريبية (فشل الاتصال بقاعدة البيانات)', 'warning');
                }
            }

            async loadChannelsFromDB() {
                try {
                    const channels = await this.supabaseRequest('channels?select=*&order=order_index.asc.nullslast,name.asc');
                    
                    if (channels && channels.length > 0) {
                        this.channels = channels.map(channel => ({
                            id: channel.id,
                            name: channel.name,
                            nameAr: channel.name_ar || channel.name,
                            description: channel.description || '',
                            descriptionAr: channel.description_ar || channel.description || '',
                            category: channel.category,
                            imageUrl: channel.image_url || 'https://placehold.co/400x300?text=' + encodeURIComponent(channel.name),
                            url: channel.url,
                            isPremium: channel.membership_type === 'premium' || channel.membership_type === 'vip',
                            isLive: channel.is_active,
                            quality: channel.quality || 'HD',
                            viewersCount: channel.viewers_count || 0,
                            rating: 4.5 + Math.random() * 0.5,
                            membershipType: channel.membership_type || 'free'
                        }));
                        
                        console.log('Loaded channels from database:', this.channels.length);
                    } else {
                        console.log('No channels found in database, using mock data');
                        this.loadMockChannels();
                    }
                } catch (error) {
                    console.error('Error loading channels from database:', error);
                    this.loadMockChannels();
                }
            }

            async loadCategoriesFromDB() {
                try {
                    const categories = await this.supabaseRequest('categories?select=*&order=order_index.asc,name.asc');
                    
                    if (categories && categories.length > 0) {
                        this.categories = categories.map(category => ({
                            id: category.id,
                            name: category.name,
                            nameAr: category.name_ar || category.name,
                            icon: this.getCategoryIcon(category.name),
                            isActive: category.is_active
                        }));
                        
                        console.log('Loaded categories from database:', this.categories.length);
                    } else {
                        console.log('No categories found in database, using mock data');
                        this.loadMockCategories();
                    }
                } catch (error) {
                    console.error('Error loading categories from database:', error);
                    this.loadMockCategories();
                }
            }

            async loadAdsFromDB() {
                try {
                    const ads = await this.supabaseRequest('advertisements?select=*&eq.is_active.true&order=created_at.desc');
                    
                    if (ads && ads.length > 0) {
                        this.ads = ads.map((ad, index) => ({
                            id: ad.id,
                            title: ad.title_ar || ad.title,
                            description: ad.description_ar || ad.description,
                            imageUrl: ad.image_url || 'https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=800&h=400&fit=crop',
                            link: ad.link || '#premium',
                            isActive: index === 0
                        }));
                        
                        console.log('Loaded ads from database:', this.ads.length);
                    } else {
                        console.log('No ads found in database, using mock data');
                        this.loadMockAds();
                    }
                } catch (error) {
                    console.error('Error loading ads from database:', error);
                    this.loadMockAds();
                }
            }

            getCategoryIcon(categoryName) {
                const iconMap = {
                    'Sports': 'fas fa-futbol',
                    'News': 'fas fa-newspaper',
                    'Entertainment': 'fas fa-masks-theater',
                    'Movies': 'fas fa-film',
                    'Kids': 'fas fa-child',
                    'General': 'fas fa-tv',
                    'Music': 'fas fa-music',
                    'Documentary': 'fas fa-file-video'
                };
                return iconMap[categoryName] || 'fas fa-tv';
            }

           
            async authenticateUser(emailOrUsername, password) {
                try {
                    console.log('Attempting authentication for:', emailOrUsername);
                    
                    let users = null;
                    
                    if (emailOrUsername.includes('@')) {
                        users = await this.supabaseRequest(`users?email=eq.${emailOrUsername}&select=*`);
                    } else {
                        users = await this.supabaseRequest(`users?username=eq.${emailOrUsername}&select=*`);
                    }
                    
                    console.log('User query results:', users);
                    
                    if (users && users.length > 0) {
                        const user = users[0];
                        console.log('User found:', user);
                        
                        if (!user.password_hash) {
                            console.error('User has no password hash');
                            return null;
                        }
                        
                        let storedPassword;
                        try {
                            storedPassword = atob(user.password_hash);
                        } catch (error) {
                            console.error('Error decoding password:', error);
                            return null;
                        }
                        
                        console.log('Password check - provided:', password, 'stored:', storedPassword);
                        
                        if (password === storedPassword) {
                            console.log('Password matches! Logging in user.');
                            
                            try {
                                await this.supabaseRequest(`users?id=eq.${user.id}`, {
                                    method: 'PATCH',
                                    body: JSON.stringify({
                                        last_login_at: new Date().toISOString()
                                    })
                                });
                            } catch (error) {
                                console.error('Error updating last login:', error);
                            }
                            
                            const authenticatedUser = {
                                id: user.id,
                                username: user.username,
                                email: user.email,
                                phone: user.phone,
                                isPremium: user.membership_type === 'premium' || user.membership_type === 'vip',
                                membershipType: user.membership_type || 'free',
                                allowedChannels: user.allowed_channels || [],
                                joinDate: new Date(user.created_at),
                                avatar: user.profile_image,
                                isActive: user.is_active !== false
                            };
                            
                            console.log('Authenticated user object:', authenticatedUser);
                            return authenticatedUser;
                        } else {
                            console.log('Password does not match');
                        }
                    } else {
                        console.log('No user found with provided credentials');
                    }
                    
                    return null;
                } catch (error) {
                    console.error('Authentication error:', error);
                    console.log('Falling back to sample user authentication');
                    return this.authenticateWithSampleUsers(emailOrUsername, password);
                }
            }

           
            authenticateWithSampleUsers(emailOrUsername, password) {
                console.log('Authenticating with sample users - input:', emailOrUsername, password);
                
                const sampleUsers = [
                    {
                        id: 'sample1',
                        username: 'user1',
                        email: 'user1@example.com',
                        password: 'user123',
                        membershipType: 'free',
                        allowedChannels: []
                    },
                    {
                        id: 'sample2',
                        username: 'premium',
                        email: 'premium@example.com',
                        password: 'premium123',
                        membershipType: 'premium',
                        allowedChannels: []
                    },
                    {
                        id: 'sample3',
                        username: 'vip',
                        email: 'vip@example.com',
                        password: 'vip123',
                        membershipType: 'vip',
                        allowedChannels: []
                    }
                ];

                const user = sampleUsers.find(u => 
                    (u.username === emailOrUsername || u.email === emailOrUsername) && 
                    u.password === password
                );

                if (user) {
                    console.log('Sample user found:', user);
                    return {
                        id: user.id,
                        username: user.username,
                        email: user.email,
                        isPremium: user.membershipType === 'premium' || user.membershipType === 'vip',
                        membershipType: user.membershipType,
                        allowedChannels: user.allowedChannels,
                        joinDate: new Date(),
                        avatar: null,
                        isActive: true
                    };
                }

                console.log('No sample user found');
                return null;
            }

           
            async toggleFavorite(channel) {
                const index = this.favorites.findIndex(f => f.id === channel.id);
                try {
                    if (index === -1) {
                       
                        this.favorites.push(channel);
                        this.showToast(`تم إضافة ${channel.nameAr} إلى المفضلة`, 'success');
                    } else {
                        
                        this.favorites.splice(index, 1);
                        this.showToast(`تم إزالة ${channel.nameAr} من المفضلة`, 'warning');
                    }
                    this.saveFavoritesToStorage();
                    this.updateStats();
                    this.updateFavoriteButtons();
                    if (this.currentTab === 'favorites') {
                        this.renderFavorites();
                    }
                } catch (error) {
                    console.error('Error updating favorites:', error);
                    this.showToast('خطأ في تحديث المفضلة', 'error');
                }
            }

            
            async loadUserFavorites() {
                this.favorites = this.loadFavoritesFromStorage();
                this.updateStats();
            }
            
            setupEventListeners() {
               
                if(this.elements.loginBtn) this.elements.loginBtn.addEventListener('click', () => this.showLoginModal());
                if(this.elements.closeModal) this.elements.closeModal.addEventListener('click', () => this.hideLoginModal());
                if(this.elements.submitLogin) this.elements.submitLogin.addEventListener('click', () => this.handleLogin());
                
                
                this.elements.closePlayer.addEventListener('click', () => this.closeVideoPlayer());
                document.getElementById('playerFullscreen').addEventListener('click', () => this.toggleFullscreen());
                document.getElementById('playerVolume').addEventListener('click', () => this.toggleMute());
                
               
                this.elements.homeBtn.addEventListener('click', () => this.showTab('home'));
                this.elements.navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        const tab = link.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
               
                document.querySelectorAll('.quick-action-btn[data-tab]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tab = btn.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
               
                this.elements.searchBtn.addEventListener('click', () => this.toggleSearch());
                this.elements.searchInput.addEventListener('input', (e) => this.handleSearch(e.target.value));
                this.elements.searchInput.addEventListener('focus', () => this.showSearchResults());
                this.elements.searchInput.addEventListener('blur', () => {
                    setTimeout(() => this.hideSearchResults(), 200);
                });
                
                
                document.getElementById('categoryFilter').addEventListener('change', (e) => {
                    this.currentFilters.category = e.target.value;
                    this.filterChannels();
                });
                
            
                document.querySelectorAll('.view-toggle-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.view-toggle-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.updateView(btn.getAttribute('data-view'));
                    });
                });
                
                
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 100) {
                        this.elements.header.classList.add('scrolled');
                    } else {
                        this.elements.header.classList.remove('scrolled');
                    }
                });
                
                
                document.querySelectorAll('.footer-links a[data-tab]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tab = link.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
                
                document.getElementById('newsletterForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleNewsletterSubscription(e);
                });
                
                
                document.getElementById('clearFavoritesBtn').addEventListener('click', () => {
                    this.clearAllFavorites();
                });
                
                
                this.elements.loginModal.addEventListener('click', (e) => {
                    if (e.target === this.elements.loginModal) {
                        this.hideLoginModal();
                    }
                });
                
                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.hideLoginModal();
                        this.closeVideoPlayer();
                        this.hideSearchResults();
                    }
                    if (e.ctrlKey && e.key === 'k') {
                        e.preventDefault();
                        this.toggleSearch();
                    }
                });

            }
            
            loadMockData() {
                this.loadMockChannels();
                this.loadMockCategories();
                this.loadMockAds();
                
                this.updateStats();
                this.renderAds();
                this.renderFeaturedChannels();
                this.renderAllChannels();
                this.populateFilters();
            }

            loadMockChannels() {
                this.channels = [
                 
                    {
                        id: '5',
                        name: 'Spacetoon',
                        nameAr: 'سبيستون',
                        description: 'قناة أطفال',
                        descriptionAr: 'قناة مخصصة لبرامج وأفلام الأطفال',
                        category: 'Kids',
                        imageUrl: 'https://images.unsplash.com/photo-1587654780291-39c9404d746b?w=400&h=300&fit=crop',
                        url: 'https://shd-gcp-live.edgenextcdn.net/live/bitmovin-spacetoon/d8382fb9ab4b2307058f12c7ea90db54/manifest/video/576p1200kbps/video.m3u8',
                        isPremium: false,
                        isLive: true,
                        quality: 'HD',
                        viewersCount: 3200,
                        rating: 4.3,
                        membershipType: 'free'
                    }
                ];
            }

            loadMockCategories() {
                this.categories = [
                    { id: '1', name: 'News', nameAr: 'أخبار', icon: 'fas fa-newspaper', isActive: true },
                    { id: '2', name: 'Sports', nameAr: 'رياضة', icon: 'fas fa-futbol', isActive: true },
                    { id: '3', name: 'Entertainment', nameAr: 'ترفيه', icon: 'fas fa-masks-theater', isActive: true },
                    { id: '4', name: 'Documentary', nameAr: 'وثائقي', icon: 'fas fa-film', isActive: true },
                    { id: '5', name: 'Kids', nameAr: 'أطفال', icon: 'fas fa-child', isActive: true },
                    { id: '6', name: 'Music', nameAr: 'موسيقى', icon: 'fas fa-music', isActive: true }
                ];
            }

            loadMockAds() {
                this.ads = [
                    
                    {
                        id: '2',
                        title: 'أحدث الأخبار الرياضية',
                        description: 'تابع أحدث الأخبار الرياضية والمباريات المباشرة',
                        imageUrl: 'https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=800&h=400&fit=crop',
                        link: '#sports',
                        isActive: true
                    },
                    {
                        id: '3',
                        title: 'أحدث البرامج الترفيهية',
                        description: 'شاهد أحدث البرامج والمسلسلات العربية والعالمية',
                        imageUrl: 'https://images.unsplash.com/photo-1489599809194-4066b6b60934?w=800&h=400&fit=crop',
                        link: '#entertainment',
                        isActive: true
                    }
                ];
            }
            
            checkUserSession() {
                const savedUser = localStorage.getItem('tvna_user');
                if (savedUser) {
                    this.currentUser = JSON.parse(savedUser);
                    this.updateUserUI();
                    this.loadUserFavorites();
                }
            }
            
            hideLoader() {
                setTimeout(() => {
                    this.elements.pageLoader.classList.add('hidden');
                    setTimeout(() => {
                        this.elements.pageLoader.style.display = 'none';
                    }, 500);
                }, 2000);
            }
            
            animateElements() {
            }
            
            showLoginModal() {
                this.elements.loginModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
            
            hideLoginModal() {
                this.elements.loginModal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
            
            async handleLogin() {
                const emailOrUsername = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!emailOrUsername || !password) {
                    this.showToast('يرجى ملء جميع الحقول', 'error');
                    return;
                }
                
                this.elements.submitLogin.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري تسجيل الدخول...';
                this.elements.submitLogin.disabled = true;
                
                try {
                    const user = await this.authenticateUser(emailOrUsername, password);
                    
                    if (user) {
                        this.currentUser = user;
                        localStorage.setItem('tvna_user', JSON.stringify(this.currentUser));
                        this.updateUserUI();
                        this.hideLoginModal();
                        this.showToast(`مرحباً ${this.currentUser.username}!`, 'success');
                        
                        
                        await this.loadUserFavorites();
                        
                        
                        document.getElementById('email').value = '';
                        document.getElementById('password').value = '';
                    } else {
                        this.showToast('اسم المستخدم أو كلمة المرور غير صحيحة', 'error');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    this.showToast('خطأ في تسجيل الدخول', 'error');
                }
                
                this.elements.submitLogin.innerHTML = 'دخول';
                this.elements.submitLogin.disabled = false;
            }
            
            updateUserUI() {
                if (this.currentUser) {
                    document.getElementById('welcomeTitle').textContent = `مرحباً ${this.currentUser.username} في TvNa`;
                    document.getElementById('welcomeSubtitle').textContent = 'استمتع الآن بأفضل القنوات المحلية والعالمية';
                    
                    this.elements.loginBtn.innerHTML = this.currentUser.avatar 
                        ? `<img src="${this.currentUser.avatar}" alt="avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">` 
                        : `<i class="fas fa-user-circle"></i>`;
                    this.elements.loginBtn.classList.add('logged-in');
                    this.elements.loginBtn.title = `مرحباً ${this.currentUser.username}`;
                    
                   
                    this.elements.loginBtn.onclick = () => this.showUserMenu();
                }
            }
            
            showUserMenu() {
                if (!this.currentUser) {
                    this.showLoginModal();
                    return;
                }
                const menu = document.createElement('div');
                menu.className = 'user-menu glass-bg rounded-xl';
                menu.style.cssText = `
                    position: absolute;
                    top: 60px;
                    right: 20px;
                    min-width: 260px;
                    padding: 1.2rem 1.2rem 1rem 1.2rem;
                    z-index: 2000;
                    backdrop-filter: blur(20px);
                    border-radius: 18px;
                    box-shadow: 0 4px 24px 0 rgba(67,97,238,0.13);
                `;
                menu.innerHTML = `
                    <div style="text-align:center;margin-bottom:1rem;">
                        <div style="font-size:2.2rem;margin-bottom:0.5rem;">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div style="font-weight: 800; font-size:1.1rem;">${this.currentUser.username}</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;">${this.currentUser.email}</div>
                        <div style="font-size: 0.85rem; opacity: 0.7; margin-top:0.2rem;">${this.currentUser.membershipType === 'premium' ? 'عضو مميز' : this.currentUser.membershipType === 'vip' ? 'عضو VIP' : 'عضو عادي'}</div>
                        <div style="font-size: 0.8rem; opacity: 0.6; margin-top:0.2rem;">انضم منذ: ${this.currentUser.joinDate ? new Date(this.currentUser.joinDate).toLocaleDateString('ar-EG') : ''}</div>
                    </div>
                    <button style="width:100%;padding:0.7rem;border-radius:10px;background:var(--danger);color:#fff;font-weight:700;border:none;cursor:pointer;" onclick="tvnaApp.logout()"><i class='fas fa-sign-out-alt'></i> تسجيل الخروج</button>
                `;
                document.body.appendChild(menu);
                setTimeout(() => {
                    document.addEventListener('click', function closeMenu(e) {
                        if (!menu.contains(e.target)) {
                            menu.remove();
                            document.removeEventListener('click', closeMenu);
                        }
                    });
                }, 100);
            }
            logout() {
                localStorage.removeItem('tvna_user');
                this.currentUser = null;
                this.elements.loginBtn.innerHTML = '<i class="fas fa-user"></i>';
                this.elements.loginBtn.classList.remove('logged-in');
                this.elements.loginBtn.onclick = () => this.showLoginModal();
                document.getElementById('welcomeTitle').textContent = 'مرحباً بك في TV HUB';
                document.getElementById('welcomeSubtitle').textContent = 'استمتع بأفضل تجربة مشاهدة للقنوات المحلية والعالمية';
                this.showToast('تم تسجيل الخروج بنجاح', 'success');
                
                this.favorites = [];
                this.saveFavoritesToStorage();
                this.updateStats();
                if (this.currentTab === 'favorites') {
                    this.renderFavorites();
                }
            }
            
            toggleSearch() {
                const input = this.elements.searchInput;
                const isActive = input.classList.contains('active');
                
                if (isActive) {
                    input.classList.remove('active');
                    input.blur();
                    this.hideSearchResults();
                } else {
                    input.classList.add('active');
                    input.focus();
                }
            }
            
            handleSearch(query) {
                this.currentFilters.search = query.toLowerCase();
                
                if (query.length === 0) {
                    this.hideSearchResults();
                    this.filterChannels();
                    return;
                }
                
                const results = this.channels.filter(channel => 
                    channel.nameAr.toLowerCase().includes(query) ||
                    channel.name.toLowerCase().includes(query) ||
                    channel.category.toLowerCase().includes(query)
                );
                
                this.showSearchResults(results);
                this.filterChannels();
            }
            
            showSearchResults(results = []) {
                const container = this.elements.searchResults;
                
                if (results.length === 0 && this.currentFilters.search.length > 0) {
                    container.innerHTML = `
                        <div class="search-result-item">
                            <div class="search-result-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="search-result-content">
                                <div class="search-result-title">لا توجد نتائج</div>
                                <div class="search-result-category">جرب كلمات بحث أخرى</div>
                            </div>
                        </div>
                    `;
                } else if (results.length > 0) {
                    container.innerHTML = results.slice(0, 5).map(channel => `
                        <div class="search-result-item" onclick="tvnaApp.selectSearchResult('${channel.id}')">
                            <div class="search-result-icon">
                                <i class="fas fa-tv"></i>
                            </div>
                            <div class="search-result-content">
                                <div class="search-result-title">${channel.nameAr}</div>
                                <div class="search-result-category">${channel.category}</div>
                            </div>
                        </div>
                    `).join('');
                    
                    if (results.length > 5) {
                        container.innerHTML += `
                            <div class="search-result-item" onclick="tvnaApp.showAllSearchResults()">
                                <div class="search-result-icon">
                                    <i class="fas fa-ellipsis-h"></i>
                                </div>
                                <div class="search-result-content">
                                    <div class="search-result-title">عرض جميع النتائج (${results.length})</div>
                                    <div class="search-result-category">انقر لعرض الكل</div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                container.style.display = 'block';
            }
            
            hideSearchResults() {
                this.elements.searchResults.style.display = 'none';
            }
            
            selectSearchResult(channelId) {
                const channel = this.channels.find(c => c.id === channelId);
                if (channel) {
                    this.playChannel(channel);
                    this.hideSearchResults();
                    this.elements.searchInput.value = '';
                    this.elements.searchInput.classList.remove('active');
                }
            }
            
            showAllSearchResults() {
                this.showTab('channels');
                this.hideSearchResults();
                this.elements.searchInput.classList.remove('active');
            }
            
            toggleTheme() {
                document.body.classList.toggle('dark-mode');
                
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('tvna_theme', 'dark');
                } else {
                    localStorage.setItem('tvna_theme', 'light');
                }
                
                this.showToast('تم تغيير المظهر', 'success');
            }
            
            showTab(tabName) {
                
                this.elements.tabContents.forEach(tab => {
                    tab.classList.remove('active');
                });
                
               
                this.elements.navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                
                const targetTab = document.getElementById(`${tabName}Tab`);
                if (targetTab) {
                    targetTab.classList.add('active');
                    this.currentTab = tabName;
                }
                
                const activeLink = document.querySelector(`.nav-link[data-tab="${tabName}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
                
                
                switch (tabName) {
                    case 'categories':
                        this.renderCategories();
                        break;
                    case 'favorites':
                        this.renderFavorites();
                        break;
                    case 'news':
                        this.renderNews();
                        break;
                    case 'channels':
                        this.filterChannels();
                        break;
                }
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            
            updateStats() {
                document.getElementById('channelsCount').textContent = this.channels.length;
                document.getElementById('favoritesCount').textContent = this.favorites.length;
            }
            
            renderAds() {
                const container = document.getElementById('adsCarousel');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.ads.forEach((ad, index) => {
                    const slide = document.createElement('div');
                    slide.className = `ad-slide ${index === 0 ? 'active' : ''}`;
                    slide.style.backgroundImage = `url('${ad.imageUrl}')`;
                    slide.innerHTML = `
                        <div class="ad-content">
                            <div class="ad-badge">مميز</div>
                            <h3 class="ad-title">${ad.title}</h3>
                            <p class="ad-desc">${ad.description}</p>
                            ${ad.link ? `<a href="${ad.link}" class="ad-link">
                                <span>المزيد</span>
                                <i class="fas fa-arrow-left"></i>
                            </a>` : ''}
                        </div>
                    `;
                    container.appendChild(slide);
                });
                
                const indicators = document.createElement('div');
                indicators.className = 'carousel-indicators';
                this.ads.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = `carousel-indicator ${index === 0 ? 'active' : ''}`;
                    indicator.onclick = () => this.goToSlide(index);
                    indicators.appendChild(indicator);
                });
                container.appendChild(indicators);
                
                const prevBtn = document.createElement('div');
                prevBtn.className = 'carousel-nav prev';
                prevBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                prevBtn.onclick = () => this.previousSlide();
                
                const nextBtn = document.createElement('div');
                nextBtn.className = 'carousel-nav next';
                nextBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                nextBtn.onclick = () => this.nextSlide();
                
                container.appendChild(prevBtn);
                container.appendChild(nextBtn);
                
            }
            
            startCarouselRotation() {
            }
            
            nextSlide() {
                const slides = document.querySelectorAll('.ad-slide');
                const indicators = document.querySelectorAll('.carousel-indicator');
                let currentIndex = 0;
                
                slides.forEach((slide, index) => {
                    if (slide.classList.contains('active')) {
                        currentIndex = index;
                    }
                });
                
                const nextIndex = (currentIndex + 1) % slides.length;
                this.goToSlide(nextIndex);
            }
            
            previousSlide() {
                const slides = document.querySelectorAll('.ad-slide');
                let currentIndex = 0;
                
                slides.forEach((slide, index) => {
                    if (slide.classList.contains('active')) {
                        currentIndex = index;
                    }
                });
                
                const prevIndex = currentIndex === 0 ? slides.length - 1 : currentIndex - 1;
                this.goToSlide(prevIndex);
            }
            
            goToSlide(index) {
                const slides = document.querySelectorAll('.ad-slide');
                const indicators = document.querySelectorAll('.carousel-indicator');
                
                slides.forEach((slide, i) => {
                    slide.classList.toggle('active', i === index);
                });
                
                indicators.forEach((indicator, i) => {
                    indicator.classList.toggle('active', i === index);
                });
            }
            
            renderFeaturedChannels() {
                const container = document.getElementById('featuredChannels');
                if (!container) return;
                
                this.channels.sort((a, b) => (a.order_index || 0) - (b.order_index || 0));
                const featured = this.channels.filter(c => c.isPremium).slice(0, 6);
                this.renderChannelsInContainer(container, featured);
            }
            
            renderAllChannels() {
                const container = document.getElementById('allChannels');
                if (!container) return;
                
                this.channels.sort((a, b) => (a.order_index || 0) - (b.order_index || 0));
                this.renderChannelsInContainer(container, this.channels);
            }
            
            renderChannelsInContainer(container, channels) {
                if (channels.length === 0) {
                    container.innerHTML = this.getEmptyState('لا توجد قنوات', 'جرب تغيير الفلاتر أو البحث');
                    return;
                }
                
                container.innerHTML = '';
                channels.forEach(channel => {
                    container.appendChild(this.createChannelCard(channel));
                });
            }
            
            createChannelCard(channel) {
                const card = document.createElement('div');
                card.className = 'channel-card fade-in';
                
                const isFavorite = this.favorites.some(f => f.id === channel.id);
                
                card.innerHTML = `
                    <div class="channel-header">
                        <img src="${channel.imageUrl}" class="channel-image" alt="${channel.nameAr}" loading="lazy" decoding="async" onerror="this.onerror=null;this.src='https://placehold.co/400x300?text=No+Image'">
                        <div class="channel-badges">
                            ${channel.isPremium ? '<div class="channel-badge premium"><i class="fas fa-crown"></i> مميز</div>' : ''}
                            ${channel.isLive ? '<div class="channel-badge live"><i class="fas fa-circle"></i> مباشر</div>' : ''}
                            ${channel.quality === 'HD' || channel.quality === 'FHD' || channel.quality === '4K' ? `<div class="channel-badge hd">${channel.quality}</div>` : ''}
                        </div>
                        <div class="channel-overlay">
                            <div class="play-overlay">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    </div>
                    <div class="channel-content">
                        <div class="channel-name-row">
                            <span class="channel-name">${channel.nameAr} <i class="fas fa-satellite"></i></span>
                        </div>
                        <div class="channel-category-row">
                            <span class="channel-category">${this.getCategoryNameAr(channel.category)}</span>
                        </div>
                        <div class="channel-rating-row">
                            <span>${channel.rating.toFixed(1)} <i class="fas fa-star"></i></span>
                        </div>
                        <div class="channel-actions">
                            <div class="channel-action-btn favorite ${isFavorite ? 'active' : ''}" 
                                 data-id="${channel.id}" data-action="favorite" 
                                 title="${isFavorite ? 'إزالة من المفضلة' : 'إضافة للمفضلة'}">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="channel-action-btn" data-id="${channel.id}" data-action="share" title="مشاركة" onclick="event.stopPropagation(); tvnaApp.shareChannelWithLink('${channel.id}')">
                                <i class="fas fa-share"></i>
                            </div>
                            <div class="channel-action-btn play-btn" data-id="${channel.id}" data-action="play">
                                <i class="fas fa-play"></i>
                                <span>مشاهدة</span>
                            </div>
                        </div>
                    </div>
                `;
                
                
                card.querySelectorAll('.channel-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const channelId = btn.getAttribute('data-id');
                        const action = btn.getAttribute('data-action');
                        this.handleChannelAction(channelId, action);
                    });
                });
                
                card.addEventListener('click', () => {
                    this.handleChannelAction(channel.id, 'play');
                });
                
                return card;
            }

            getCategoryNameAr(categoryName) {
                const category = this.categories.find(c => c.name === categoryName);
                return category ? category.nameAr : categoryName;
            }
            
            handleChannelAction(channelId, action) {
                const channel = this.channels.find(c => c.id === channelId);
                if (!channel) return;
                
                switch (action) {
                    case 'favorite':
                        this.toggleFavorite(channel);
                        break;
                    case 'share':
                        this.shareChannel(channel);
                        break;
                    case 'play':
                        this.playChannel(channel);
                        break;
                }
            }
            
            shareChannel(channel) {
                if (navigator.share) {
                    navigator.share({
                        title: channel.nameAr,
                        text: channel.descriptionAr,
                        url: window.location.href
                    });
                } else {
                    const shareText = `${channel.nameAr} - ${channel.descriptionAr}\n${window.location.href}`;
                    navigator.clipboard.writeText(shareText).then(() => {
                        this.showToast('تم نسخ رابط القناة', 'success');
                    });
                }
            }
            
            playChannel(channel) {
                this.showVideoPlayer(channel);
            }
            
            showVideoPlayer(channel) {
                this.elements.videoPlayer.classList.add('show');
                document.body.style.overflow = 'hidden';
               
                try {
                    if (Hls.isSupported()) {
                        const hls = new Hls();
                        hls.loadSource(channel.url);
                        hls.attachMedia(this.elements.playerElement);
                        hls.on(Hls.Events.MANIFEST_PARSED, () => {
                            this.elements.playerElement.play();
                           
                        });
                        
                    } else if (this.elements.playerElement.canPlayType('application/vnd.apple.mpegurl')) {
                        this.elements.playerElement.src = channel.url;
                        this.elements.playerElement.addEventListener('loadedmetadata', () => {
                            this.elements.playerElement.play();
                          
                        });
                    } else {
                        
                        this.showToast('تعذر تشغيل القناة - هذا عرض تجريبي', 'error');
                        this.closeVideoPlayer();
                    }
                } catch (error) {
                    console.error('Error playing channel:', error);
                    this.showToast('تعذر تشغيل القناة', 'error');
                    this.closeVideoPlayer();
                }
            }
            
            closeVideoPlayer() {
                this.elements.videoPlayer.classList.remove('show');
                document.body.style.overflow = 'auto';
                
                if (this.elements.playerElement) {
                    this.elements.playerElement.pause();
                    this.elements.playerElement.src = '';
                }
            }
            
            toggleFullscreen() {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    this.elements.videoPlayer.requestFullscreen();
                }
            }
            
            toggleMute() {
                const player = this.elements.playerElement;
                player.muted = !player.muted;
                
                const icon = document.getElementById('playerVolume').querySelector('i');
                if (player.muted) {
                    icon.classList.remove('fa-volume-up');
                    icon.classList.add('fa-volume-mute');
                } else {
                    icon.classList.remove('fa-volume-mute');
                    icon.classList.add('fa-volume-up');
                }
            }
            
            renderCategories() {
                const container = document.getElementById('categoriesContent');
                if (!container) return;
                container.innerHTML = '';
                this.categories.forEach(category => {
                    const categoryChannels = this.channels.filter(c => c.category === category.name);
                    const isEmpty = categoryChannels.length === 0;
                    const card = document.createElement('div');
                    card.className = 'channel-card fade-in';
                    if(isEmpty) card.style.maxWidth = '220px', card.style.minWidth = '140px', card.style.padding = '1.2rem 0.5rem 1rem 0.5rem';
                    card.innerHTML = `
                        <div class="channel-header">
                            <div style="background: var(--gradient-card); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(20px);">
                                <i class="${category.icon}" style="font-size: 4rem; background: var(--premium); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
                            </div>
                        </div>
                        <div class="channel-content">
                            <h3 class="channel-name">
                                <i class="${category.icon}"></i>
                                ${category.nameAr}
                            </h3>
                            <p class="channel-desc">${categoryChannels.length} قنوات متاحة</p>
                            <div class="channel-stats">
                                <div class="stat">
                                    <i class="fas fa-tv"></i>
                                    <span>${categoryChannels.length} قنوات</span>
                                </div>
                            </div>
                            <div class="channel-actions">
                                <div class="channel-action-btn play-btn" data-category="${category.name}">
                                    <i class="fas fa-eye"></i>
                                    <span>عرض القنوات</span>
                                </div>
                            </div>
                        </div>
                    `;
                    card.querySelector('.play-btn').addEventListener('click', () => {
                        this.showCategoryChannels(category.name);
                    });
                    container.appendChild(card);
                });
            }
            
            showCategoryChannels(category) {
                this.currentFilters.category = category;
                this.showTab('channels');
                
                
                document.getElementById('categoryFilter').value = category;
                this.filterChannels();
                
                
                setTimeout(() => {
                    document.getElementById('allChannels').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }
            
            renderFavorites() {
                const container = document.getElementById('favoritesContent');
                if (!container) return;
                
                if (this.favorites.length === 0) {
                    container.innerHTML = this.getEmptyState(
                        'لا توجد قنوات مفضلة',
                        'أضف بعض القنوات إلى مفضلتك لتظهر هنا',
                        'fas fa-heart'
                    );
                    return;
                }
                
                this.renderChannelsInContainer(container, this.favorites);
            }
            
            renderNews() {
                const container = document.getElementById('newsContent');
                if (!container) return;
                
                const newsChannels = this.channels.filter(c => c.category === 'News' || c.category === 'Sports');
                this.renderChannelsInContainer(container, newsChannels);
            }
            
            populateFilters() {
                const categoryFilter = document.getElementById('categoryFilter');
                if (!categoryFilter) return;
                
                
                categoryFilter.innerHTML = '<option value="">جميع الأقسام</option>';
                
                this.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.name;
                    option.textContent = category.nameAr;
                    categoryFilter.appendChild(option);
                });
            }
            
            filterChannels() {
                let featured = this.channels.filter(c => c.is_top === true || c.is_top === 1).sort((a,b)=>(a.order_index||0)-(b.order_index||0));
                let normal = this.channels.filter(c => !c.is_top || c.is_top === false || c.is_top === 0).sort((a,b)=>(a.order_index||0)-(b.order_index||0));
                let filtered = [...featured, ...normal];
                filtered.sort((a, b) => (a.order_index || 0) - (b.order_index || 0));
                if (this.currentFilters.category) {
                    filtered = filtered.filter(c => c.category === this.currentFilters.category);
                }
                if (this.currentFilters.search) {
                    filtered = filtered.filter(c => 
                        c.nameAr.toLowerCase().includes(this.currentFilters.search) ||
                        c.name.toLowerCase().includes(this.currentFilters.search) ||
                        c.category.toLowerCase().includes(this.currentFilters.search)
                    );
                }
                this.renderChannelsInContainer(document.getElementById('allChannels'), filtered);
            }
            
            sortChannels() {
                this.filterChannels();
            }
            
            clearAllFavorites() {
                if (this.favorites.length === 0) {
                    this.showToast('لا توجد قنوات مفضلة لحذفها', 'warning');
                    return;
                }
                
                if (confirm('هل أنت متأكد من حذف جميع القنوات المفضلة؟')) {
                    this.favorites = [];
                    this.saveFavoritesToStorage();
                    this.updateStats();
                    this.updateFavoriteButtons();
                    this.renderFavorites();
                    this.showToast('تم حذف جميع القنوات المفضلة', 'success');
                }
            }
            
            showPremiumModal() {
                const modal = document.createElement('div');
                modal.className = 'modal show';
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="close-modal" onclick="this.parentElement.parentElement.remove(); document.body.style.overflow = 'auto';">
                            <i class="fas fa-times"></i>
                        </div>
                        <h2 class="modal-title">
                            <i class="fas fa-crown" style="color: var(--warning);"></i>
                            العضوية المميزة
                        </h2>
                        
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <div style="font-size: 3rem; font-weight: 900; background: var(--premium); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                1.500 د.ع 
                            </div>
                            <div style="opacity: 0.7;">شهرياً</div>
                        </div>
                        
                        <div style="margin-bottom: 2rem;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>وصول كامل لجميع القنوات المميزة</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>جودة 4K فائقة الوضوح</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>مشاهدة بدون إعلانات</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>تسجيل البرامج والمباريات</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>دعم فني</span>
                            </div>
                        </div>
                        
                        <button class="modal-btn" onclick="tvnaApp.handlePremiumUpgrade(this)">
                            <i class="fas fa-crown"></i>
                            اشترك الآن
                        </button>
                        
                        <div class="modal-footer">
                            <p>يمكنك إلغاء الاشتراك في أي وقت</p>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                document.body.style.overflow = 'hidden';
            }
            
            handlePremiumUpgrade(button) {
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري المعالجة...';
                button.disabled = true;
                
                setTimeout(() => {
                    if (this.currentUser) {
                        this.currentUser.isPremium = true;
                        this.currentUser.membershipType = 'premium';
                        localStorage.setItem('tvna_user', JSON.stringify(this.currentUser));
                        this.updateUserUI();
                    }
                    
                    document.querySelector('.modal.show').remove();
                    document.body.style.overflow = 'auto';
                    this.showToast('مرحباً في العضوية المميزة! 🎉', 'success');
                }, 2000);
            }
            
            handleNewsletterSubscription(e) {
                const email = e.target.querySelector('input').value;
                if (!this.isValidEmail(email)) {
                    this.showToast('يرجى إدخال بريد إلكتروني صحيح', 'error');
                    return;
                }
                
                const button = e.target.querySelector('button');
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                button.disabled = true;
                
                setTimeout(() => {
                    e.target.reset();
                    button.innerHTML = originalHTML;
                    button.disabled = false;
                    this.showToast('تم الاشتراك في النشرة البريدية بنجاح!', 'success');
                }, 1500);
            }
            
            showToast(message, type = 'info', duration = 3000) {
                const toast = document.createElement('div');
                toast.className = `toast ${type} show`;
                
                const icons = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle',
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle'
                };
                
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="${icons[type] || icons.info}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-message">${message}</div>
                    </div>
                    <div class="toast-close">
                        <i class="fas fa-times"></i>
                    </div>
                `;
                
                this.elements.toastContainer.appendChild(toast);
                
               
                setTimeout(() => toast.classList.add('show'), 100);
                
                
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    this.removeToast(toast);
                });
            
                
                setTimeout(() => {
                    this.removeToast(toast);
                }, duration);
                
                
                try {
                  const audio = document.getElementById('notifSound');
                  if(audio){ audio.currentTime = 0; audio.play().catch(()=>{}); }
                } catch(e){}
            }
            
            removeToast(toast) {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }
            getEmptyState(title, message, icon = 'fas fa-tv') {
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="${icon}"></i>
                        </div>
                        <div class="empty-state-title">${title}</div>
                        <div class="empty-state-message">${message}</div>
                    </div>
                `;
            }
            loadFavoritesFromStorage() {
                try {
                    const saved = localStorage.getItem('tvna_favorites');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.error('Error loading favorites:', error);
                    return [];
                }
            }
            saveFavoritesToStorage() {
                try {
                    localStorage.setItem('tvna_favorites', JSON.stringify(this.favorites));
                } catch (error) {
                    console.error('Error saving favorites:', error);
                }
            }
            formatNumber(num) {
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toString();
            }
            
            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

        }
        
        
        let tvnaApp;
        document.addEventListener('DOMContentLoaded', () => {
            tvnaApp = new TvNaApp();
        });
        
        
        window.tvnaApp = {
            selectSearchResult: (id) => tvnaApp.selectSearchResult(id),
            showAllSearchResults: () => tvnaApp.showAllSearchResults(),
            handlePremiumUpgrade: (btn) => tvnaApp.handlePremiumUpgrade(btn),
            logout: () => tvnaApp.logout(),
            shareChannelWithLink: function(channelId) {
                const url = window.location.origin + '/channel/' + channelId;
                if (navigator.share) {
                    navigator.share({
                        title: 'رابط القناة',
                        url
                    });
                } else {
                    navigator.clipboard.writeText(url).then(() => {
                        tvnaApp.showToast('تم نسخ رابط القناة', 'success');
                    });
                }
            }
        };
        const newsSources = {
          all: [
            'https://www.aljazeera.net/aljazeera/rss',
            'https://www.aljazeera.net/aljazeeralive/rss',
            'https://aawsat.com/home/rss.xml',
            'https://www.youm7.com/rss/SectionRss?SectionID=65',
            'https://arabic.rt.com/rss/',
            'https://www.aa.com.tr/ar/rss/default?cat=general',
            'https://arabic.cnn.com/rss',
            'https://sabq.org/rss',
            'https://www.alriyadh.com/rss',
            'https://alwatannews.net/rss',
            'https://www.albayan.ae/polopoly_fs/1.2011971.1495780426!/menu/standard/file/rss.xml',
            'https://www.alsumaria.tv/rss/ar-iraq-news',
            'https://www.alarabiya.net/.mrss/ar.xml',
            'https://www.skynewsarabia.com/web/rss/latest.xml',
            'https://www.bbc.com/arabic/index.xml',
            'https://www.kooora.com/?n=0&o=rss',
            'https://www.yallakora.com/rss/News',
            'https://aitnews.com/feed/'
          ],
          sports: [
            'https://www.kooora.com/?n=0&o=rss',
            'https://www.yallakora.com/rss/News',
            'https://www.filgoal.com/rss/news',
            'https://www.koraplus.com/rss',
            'https://www.koraon.com/feed/',
            'https://www.skynewsarabia.com/web/rss/sports.xml',
            'https://www.alarabiya.net/.mrss/ar/sports.xml',
            'https://arabic.rt.com/rss/sports/',
            'https://arriyadiyah.com/rss',
            'https://www.alyaum.com/rss/categories/3',
            'https://www.kooranew.com/feed/',
            'https://kora365.com/feed/',
            'https://www.btolat.com/rss/news',
            'https://www.superkora.football/rss',
            'https://arabic.sport360.com/feed'
          ],
          technology: [
            'https://aitnews.com/feed/'
          ],
          general: [
            'https://www.aljazeera.net/aljazeera/rss',
            'https://www.aljazeera.net/aljazeeralive/rss',
            'https://aawsat.com/home/rss.xml',
            'https://www.youm7.com/rss/SectionRss?SectionID=65',
            'https://arabic.rt.com/rss/',
            'https://www.aa.com.tr/ar/rss/default?cat=general',
            'https://arabic.cnn.com/rss',
            'https://sabq.org/rss',
            'https://www.alriyadh.com/rss',
            'https://alwatannews.net/rss',
            'https://www.albayan.ae/polopoly_fs/1.2011971.1495780426!/menu/standard/file/rss.xml',
            'https://www.alsumaria.tv/rss/ar-iraq-news',
            'https://www.alarabiya.net/.mrss/ar.xml',
            'https://www.skynewsarabia.com/web/rss/latest.xml',
            'https://www.bbc.com/arabic/index.xml'
          ]
        };
        async function fetchRSS(url) {
          try {
            const resp = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`);
            return await resp.json();
          } catch {
            return null;
          }
        }
        async function loadNews(type = 'all') {
          const grid = document.getElementById('newsCardsGrid');
          grid.innerHTML = '<div style="text-align:center;padding:2rem;">جاري تحميل الأخبار...</div>';
          let allNews = [];
          for (const src of newsSources[type]) {
            const data = await fetchRSS(src);
            if (data && data.items) {
              allNews = allNews.concat(data.items.map(item => ({
                title: item.title,
                link: item.link,
                description: item.description,
                image: item.thumbnail || item.enclosure?.link || '',
                pubDate: item.pubDate,
                source: data.feed.title || '',
              })));
            }
          }
          
          allNews.sort((a,b)=>new Date(b.pubDate)-new Date(a.pubDate));
          
          const uniqueNews = [];
          const seenTitles = new Set();
          const seenLinks = new Set();
          for (const news of allNews) {
            const title = (news.title || '').trim();
            const link = (news.link || '').trim();
            if (!seenTitles.has(title) && !seenLinks.has(link)) {
              uniqueNews.push(news);
              seenTitles.add(title);
              seenLinks.add(link);
            }
          }
          grid.innerHTML = uniqueNews.slice(0, 40).map(news => `
            <div class="news-card" style="background:var(--glass);border-radius:16px;box-shadow:0 2px 12px rgba(67,97,238,0.08);overflow:hidden;display:flex;flex-direction:column;">
              ${news.image ? `<img src="${news.image}" alt="news" style="width:100%;height:160px;object-fit:cover;" loading="lazy" decoding="async" onerror="this.onerror=null;this.src='https://placehold.co/400x300?text=No+Image'">` : ''}
              <div style="padding:1rem;flex:1;display:flex;flex-direction:column;justify-content:space-between;">
                <div>
                  <div style="font-weight:800;font-size:1.1rem;margin-bottom:0.5rem;">${news.title}</div>
                  <div style="font-size:0.95rem;opacity:0.8;margin-bottom:0.7rem;">${news.description?.replace(/<[^>]+>/g,'').slice(0,120)}...</div>
                </div>
                <div style="display:flex;align-items:center;justify-content:space-between;">
                  <span style="font-size:0.85rem;opacity:0.7;">${news.source}</span>
                  <a href="${news.link}" target="_blank" rel="noopener noreferrer" style="background:var(--primary);color:#fff;padding:0.4rem 1rem;border-radius:8px;text-decoration:none;font-size:0.95rem;">اقرأ المزيد</a>
                </div>
              </div>
            </div>
          `).join('');
        }
        if(document.getElementById('newsCardsGrid')){
          let currentNewsType = 'all';
          function reloadNews() {
            loadNews(currentNewsType);
          }
          reloadNews();
          document.querySelectorAll('.news-filter-btn').forEach(btn=>{
            btn.onclick = function(){
              document.querySelectorAll('.news-filter-btn').forEach(b=>b.classList.remove('active'));
              btn.classList.add('active');
              currentNewsType = btn.getAttribute('data-type');
              reloadNews();
            };
          });
          setInterval(reloadNews, 180000);
        }
        document.addEventListener('DOMContentLoaded', function () {
          if (window.Plyr) {
            window.tvnaPlyr = new Plyr('#player', {
              controls: [
                'play-large', 'play', 'progress', 'current-time', 'duration', 'mute', 'volume',
                'settings', 'pip', 'airplay', 'fullscreen'
              ],
              settings: ['quality', 'speed', 'loop'],
              speed: { selected: 1, options: [0.5, 1, 1.5, 2] },
              quality: { default: 720, options: [360, 480, 720, 1080] },
              i18n: { speed: 'السرعة', quality: 'الدقة', settings: 'الإعدادات' }
            });
          }
        });

        document.addEventListener('DOMContentLoaded', function(){
          var btn = document.getElementById('testNotifSoundBtn');
          var msg = document.getElementById('notifSoundMsg');
          if(btn){
            btn.onclick = function(){
              var audio = document.getElementById('notifSound');
              if(audio){
                audio.currentTime = 0;
                audio.play().then(()=>{
                  if(window.tvnaApp) tvnaApp.showToast('تم تشغيل صوت الإشعار بنجاح','success',2000);
                  if(msg) msg.style.display = 'none';
                }).catch(()=>{
                  if(window.tvnaApp) tvnaApp.showToast('يرجى الضغط مرة أخرى أو السماح بالصوت من المتصفح','warning',3000);
                  if(msg) msg.style.display = 'block';
                });
              }
            };
          }
        });
    </script>
    <script>
    
    window.addEventListener('contextmenu', function(e) {
      e.preventDefault();
    });
    
    window.addEventListener('keydown', function(e) {
      if (
        e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'C')) ||
        (e.ctrlKey && e.key === 'U')
      ) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }
    });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      var userBtn = document.getElementById('loginBtn');
      if (!userBtn) return;
      let pressTimer;
      userBtn.addEventListener('mousedown', function(e) {
        pressTimer = setTimeout(function() {
          alert('developer : Ameer_7elwas');
        }, 6000);
      });
      userBtn.addEventListener('mouseup', function(e) {
        clearTimeout(pressTimer);
      });
      userBtn.addEventListener('mouseleave', function(e) {
        clearTimeout(pressTimer);
      });
      userBtn.addEventListener('touchstart', function(e) {
        pressTimer = setTimeout(function() {
          alert('developer : Ameer_7elwas');
        }, 6000);
      }, { passive: true });
      userBtn.addEventListener('touchend', function(e) {
        clearTimeout(pressTimer);
      });
    });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      var favCard = document.getElementById('favoritesStatCard');
      var chCard = document.getElementById('channelsStatCard');
      if(favCard) favCard.onclick = function(){
        if(window.tvnaApp && typeof tvnaApp.showTab === 'function') tvnaApp.showTab('favorites');
      };
      if(chCard) chCard.onclick = function(){
        if(window.tvnaApp && typeof tvnaApp.showTab === 'function') tvnaApp.showTab('channels');
      };
    });
    </script>
</body>
</html>