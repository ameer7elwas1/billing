<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¬Ø§Ø±ÙŠ</title>
    <style>
        body { font-family: 'Cairo', Arial, sans-serif; background: #f7f7fa; margin: 0; }
        .main-layout { display: flex; }
        .sidebar { width: 260px; background: #fff; min-height: 100vh; box-shadow: 2px 0 8px #eee; padding: 24px 12px; }
        .content { flex: 1; padding: 32px; }
        .section-title { font-size: 1.3em; margin-bottom: 16px; color: #0077b6; }
        .form-group { margin-bottom: 16px; }
        .btn { background: #0077b6; color: #fff; border: none; padding: 8px 18px; border-radius: 6px; cursor: pointer; }
        .btn:disabled { opacity: 0.6; }
        .item-card { background: #fff; border-radius: 8px; box-shadow: 0 1px 4px #eee; padding: 16px; margin-bottom: 12px; }
        .virtual-list { min-height: 60px; }
        .login-container { display: flex; min-height: 100vh; align-items: center; justify-content: center; }
        .login-card { background: #fff; border-radius: 12px; box-shadow: 0 2px 12px #eee; padding: 32px 24px; width: 320px; }
        .loading-bar { height: 4px; background: #0077b6; width: 0; transition: width 0.3s; }
        .notifications { position: fixed; top: 16px; left: 16px; z-index: 9999; }
        .hidden { display: none !important; }
    </style>
</head>
<body data-theme="light">
    <div class="loading-bar" id="loadingBar"></div>
    <div class="notifications" id="notifications"></div>
    <div class="connection-indicator" id="connectionIndicator">ğŸŸ¢ Ù…ØªØµÙ„</div>
    <div class="refresh-indicator" id="refreshIndicator">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...</div>
    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div class="login-container" id="loginScreen">
        <div class="login-card">
            <h1>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" id="loginUsername" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" id="loginPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <button class="btn" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="dashboard" style="display:none;">
        <div class="main-layout">
            <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
            <div class="sidebar">
                <div class="quick-links">
                    <h3>ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h3>
                    <a href="#employeesList" class="quick-link" onclick="scrollToSection('employeesList')">ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙØ±Ø§Ø¯</a>
                    <a href="#centersList" class="quick-link" onclick="scrollToSection('centersList')">ğŸ¢ Ø§Ù„Ù…Ø±Ø§ÙƒØ²</a>
                    <a href="#employeeLocations" class="quick-link" onclick="scrollToSection('employeeLocations')">ğŸ“ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©</a>
                    <a href="#activityLogs" class="quick-link" onclick="scrollToSection('activityLogs')">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</a>
                </div>
                <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ² -->
                <div class="sidebar-section" id="addCenterSection">
                    <div class="section-header section-header-center" onclick="toggleSection('centerSection')">
                        <span>ğŸ¢ Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ² Ø¬Ø¯ÙŠØ¯</span>
                        <span class="toggle-icon">â–¼</span>
                    </div>
                    <div class="section-content collapsed" id="centerSection">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙƒØ²</label>
                            <input type="text" id="centerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙƒØ²">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</label>
                            <input type="text" id="centerCoordinates" placeholder="Ù…Ø«Ø§Ù„: 32.53843, 44.184436">
                        </div>
                        <div class="form-group">
                            <label>Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø±ÙƒØ² (Ù…ØªØ±)</label>
                            <input type="number" id="centerRadius" value="100" placeholder="100">
                        </div>
                        <button class="btn" onclick="addCenter()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙƒØ²</button>
                    </div>
                </div>
                <!-- Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¯ -->
                <div class="sidebar-section" id="addEmployeeSection">
                    <div class="section-header section-header-employee" onclick="toggleSection('employeeSection')">
                        <span>ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¯ Ø¬Ø¯ÙŠØ¯</span>
                        <span class="toggle-icon">â–¼</span>
                    </div>
                    <div class="section-content collapsed" id="employeeSection">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¯</label>
                            <input type="text" id="employeeName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¯">
                        </div>
                        <div class="form-group">
                            <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="text" id="employeePhone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ù†ØµØ¨</label>
                            <input type="text" id="employeePosition" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù†ØµØ¨">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø®ØµØµ</label>
                            <select id="employeeCenter"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±ÙƒØ²</option></select>
                        </div>
                        <button class="btn" onclick="addEmployee()">Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¯</button>
                    </div>
                </div>
                <!-- ØªÙ… Ø­Ø°Ù Ù‚Ø³Ù… Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ ÙˆÙ‚Ø³Ù… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            </div>
            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
            <div class="content">
                <div class="data-section">
                    <h2 class="section-title">ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                        <div>
                            <h3 style="color: var(--text-color); margin-bottom: 15px;">Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
                            <div class="virtual-list" id="centersList"></div>
                        </div>
                        <div>
                            <h3 style="color: var(--text-color); margin-bottom: 15px;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙØ±Ø§Ø¯</h3>
                            <div class="virtual-list" id="employeesList"></div>
                            <div class="pagination" id="employeesPagination" style="display: none;">
                                <button onclick="previousPage('employees')">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                                <span id="employeesPageInfo">ØµÙØ­Ø© 1 Ù…Ù† 1</span>
                                <button onclick="nextPage('employees')">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª -->
                <div class="data-section">
                    <div class="section-title">
                        <span>ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª </span>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <select id="logFilter" onchange="filterLogs()">
                                <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</option>
                                <option value="checkin">Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø·</option>
                                <option value="checkout">Ø®Ø±ÙˆØ¬ ÙÙ‚Ø·</option>
                                <option value="movement">Ø­Ø±ÙƒØ§Øª ÙÙ‚Ø·</option>
                                <option value="center_entry">Ø¯Ø®Ù„ Ù…Ø±ÙƒØ²</option>
                            </select>
                            <button class="btn btn-small" onclick="refreshLogs()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
                        </div>
                    </div>
                    <div class="movement-search" style="margin-bottom: 20px;">
                        <input type="text" id="searchLogs" placeholder="ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ..." oninput="filterLogs()">
                        <button class="btn btn-small" onclick="clearLogSearch()">Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«</button>
                        <button class="btn btn-small" onclick="exportFilteredLogs()" title="ØªØµØ¯ÙŠØ± Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©">ğŸ“Š ØªØµØ¯ÙŠØ±</button>
                    </div>
                    <div class="logs-container" id="activityLogs">
                        <div class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª...</div>
                    </div>
                    <div class="pagination" id="logsPagination" style="display: none;">
                        <button onclick="previousPage('logs')">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <span id="logsPageInfo">ØµÙØ­Ø© 1 Ù…Ù† 1</span>
                        <button onclick="nextPage('logs')">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
    function updateSectionsVisibility() {
        const addCenterSection = document.getElementById('addCenterSection');
        const addEmployeeSection = document.getElementById('addEmployeeSection');
        const addUserSection = document.getElementById('addUserSection');
        const employeePermissionWarning = document.getElementById('employeePermissionWarning');
        const usersListSection = document.getElementById('usersListSection');

        if (addCenterSection && !window.appState?.userPermissions?.can_add_centers) {
            addCenterSection.style.display = 'none';
        }
        if (addEmployeeSection && !window.appState?.userPermissions?.can_add_employees) {
            addEmployeeSection.style.display = 'none';
        } else if (employeePermissionWarning && window.appState?.currentUser?.role !== 'admin') {
            employeePermissionWarning.style.display = 'block';
        }
        if (addUserSection && window.appState?.currentUser?.role === 'admin') {
            addUserSection.style.display = 'block';
            if (usersListSection) {
                usersListSection.style.display = 'block';
                if (typeof loadUsersList === 'function') loadUsersList();
            }
        } else {
            if (addUserSection) addUserSection.style.display = 'none';
            if (usersListSection) usersListSection.style.display = 'none';
        }
    }
    </script>
</body>
</html> 